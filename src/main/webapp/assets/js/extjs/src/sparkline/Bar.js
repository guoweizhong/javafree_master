Ext.define("Ext.sparkline.Bar",{extend:"Ext.sparkline.BarBase",requires:["Ext.sparkline.RangeMap"],alias:"widget.sparklinebar",config:{barColor:"#3366cc",negBarColor:"#f44",stackedBarColor:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],zeroColor:null,nullColor:null,zeroAxis:true,barWidth:4,barSpacing:1,chartRangeMin:null,chartRangeMax:null,chartRangeClip:false,colorMap:null},tipTpl:"&#9679; {prefix}{value}{suffix}",remove:function(e,c){var b,d,a=[];
for(b=0,d=e.length;b<d;b++){if(e[b]!==c){a.push(e[b]);}}return a;},all:function(b,d,a){var c;for(c=b.length;c--;){if(a&&b[c]===null){continue;}if(b[c]!==d){return false;}}return true;},applyColorMap:function(a){var b=this;if(Ext.isArray(a)){b.colorMapByIndex=a;b.colorMapByValue=null;}else{b.colorMapByIndex=null;
b.colorMapByValue=a;if(b.colorMapByValue&&b.colorMapByValue.get==null){b.colorMapByValue=new Ext.sparkline.RangeMap(a);}}b.updateConfigChange();return a;},onUpdate:function(){var H=this,c=H.values,s=H.getBarWidth(),p=H.getBarSpacing(),h=H.getChartRangeMin(),k=H.getChartRangeMax(),l=H.getChartRangeClip(),C=Infinity,F=-Infinity,u,q,t,e,f,A,g,r,y=H.getZeroAxis(),n,w,z,B,E,D,v,x,G,o,I,m,d,b=[],a=[];
for(A=0,g=c.length;A<g;A++){I=c[A];u=typeof(I)==="string"&&I.indexOf(":")>-1;if(u||Ext.isArray(I)){D=true;if(u){I=c[A]=H.normalizeValues(I.split(":"));}I=H.remove(I,null);q=Math.min.apply(Math,I);t=Math.max.apply(Math,I);if(q<C){C=q;}if(t>F){F=t;}}}H.stacked=D;H.regionShapes={};H.totalBarWidth=s+p;H.width=(c.length*s)+((c.length-1)*p);
if(l){B=h==null?-Infinity:h;E=k==null?Infinity:k;}f=[];e=D?[]:f;for(A=0,g=c.length;A<g;A++){if(D){v=c[A];c[A]=o=[];b[A]=0;e[A]=a[A]=0;for(x=0,G=v.length;x<G;x++){I=o[x]=l?Ext.Number.constrain(v[x],B,E):v[x];if(I!==null){if(I>0){b[A]+=I;}if(C<0&&F>0){if(I<0){a[A]+=Math.abs(I);}else{e[A]+=I;}}else{e[A]+=Math.abs(I-(I<0?F:C));
}f.push(I);}}}else{I=l?Ext.Number.constrain(c[A],B,E):c[A];I=c[A]=H.normalizeValue(I);if(I!==null){f.push(I);}}}H.max=z=Math.max.apply(Math,f);H.min=w=Math.min.apply(Math,f);H.stackMax=F=D?Math.max.apply(Math,b):z;H.stackMin=C=D?Math.min.apply(Math,f):w;if(h!=null&&(l||h<w)){w=h;}if(k!=null&&(l||k>z)){z=k;
}if(w<=0&&z>=0&&y){n=0;}else{if(!y){n=w;}else{if(w>0){n=w;}else{n=z;}}}H.xAxisOffset=n;r=D?(Math.max.apply(Math,e)+Math.max.apply(Math,a)):z-w;H.canvasHeightEf=(y&&w<0)?H.getHeight()-2:H.getHeight()-1;if(w<n){d=(D&&z>=0)?F:z;m=(d-n)/r*H.getHeight();if(m!==Math.ceil(m)){H.canvasHeightEf-=2;m=Math.ceil(m);
}}else{m=H.getHeight();}H.yoffset=m;H.range=r;},getRegion:function(b,c){var a=Math.floor(b/this.totalBarWidth);return(a<0||a>=this.values.length)?undefined:a;},getRegionFields:function(e){var b=Ext.Array.from(this.values[e]),a=[],d,c;for(c=b.length;c--;){d=b[c];a.push({isNull:d===null,value:d,color:this.calcColor(c,d,e),offset:e});
}return a;},calcColor:function(i,h,d){var f=this,b=f.colorMapByIndex,g=f.colorMapByValue,a,e,c=f.getZeroColor();if(this.stacked){a=f.getStackedBarColor();}else{a=(h<0)?f.getNegBarColor():f.getBarColor();}if(h===0&&c!=null){a=c;}if(g&&(e=g.get(h))){a=e;}else{if(b&&b.length>d){a=b[d];}}return Ext.isArray(a)?a[i%a.length]:a;
},renderRegion:function(k,e){var w=this,m=w.values[k],a=w.xAxisOffset,n=w.range,v=w.stacked,c=w.canvas,p=w.getBarWidth(),h=k*w.totalBarWidth,b=w.canvasHeightEf,j=w.yoffset,g,q,s,r,f,t,d,z,u,l,o=w.getNullColor();m=Ext.isArray(m)?m:[m];d=m.length;z=m[0];r=w.all(m,null);l=w.all(m,a,true);if(r){if(o){s=e?o:w.calcHighlightColor(o,w);
g=(j>0)?j-1:j;c.drawRect(h,g,p-1,0,s,s).append();}return;}f=j;for(t=0;t<d;t++){z=m[t];if(v&&z===a){if(!l||u){continue;}u=true;}if(n>0){q=Math.floor(b*((Math.abs(z-a)/n)))+1;}else{q=1;}if(z<a||(z===a&&j===0)){g=f;f+=q;}else{g=j-q;j-=q;}s=w.calcColor(t,z,k);if(e){s=w.calcHighlightColor(s,w);}c.drawRect(h,g,p-1,q-1,s,s).append();
}}},function(a){a.onClassCreated(a);});