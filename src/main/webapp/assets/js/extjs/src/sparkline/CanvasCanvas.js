Ext.define("Ext.sparkline.CanvasCanvas",{extend:"Ext.sparkline.CanvasBase",statics:{contextOverrides:(function(){var a=window.devicePixelRatio||1;return{moveTo:function(b,c){if(this.rtl){b=this.canvas.width-b-1;}this.$moveTo(b*a,c*a);},lineTo:function(b,c){if(this.rtl){b=this.canvas.width-b-1;}this.$lineTo(b*a,c*a);
},arc:function(c,g,b,f,d,e){if(this.rtl){c=this.canvas.width-c-1;}this.$arc(c*a,g*a,b*a,f,d,e);},clearRect:function(c,e,d,b){if(this.rtl){c=this.canvas.width-c-d;}this.$clearRect(c*a,e*a,d*a,b*a);}};})()},setWidth:function(a){this.callParent(arguments);this.owner.element.dom.width=a*(window.devicePixelRatio||1);
},setHeight:function(a){this.callParent(arguments);this.owner.element.dom.height=a*(window.devicePixelRatio||1);},onOwnerUpdate:function(){var a=this;a.el=a.owner.element;a.interact=!a.owner.initialConfig.disableInteraction;a.shapes={};a.shapeseq=[];a.currentTargetShapeId=a.lastShapeId=null;},_getContext:function(d,f,a){var c=this.context,e,b;
if(!c){this.context=c=this.el.dom.getContext("2d");e=Ext.sparkline.CanvasCanvas.contextOverrides;for(b in e){c["$"+b]=c[b];}Ext.apply(c,e);c.rtl=this.rtl;}if(d!=null){c.strokeStyle=d;}c.lineWidth=a||1;if(f!=null){c.fillStyle=f;}return c;},reset:function(){var a=this._getContext();a.clearRect(0,0,this.pixelWidth,this.pixelHeight);
this.shapes={};this.shapeseq=[];this.currentTargetShapeId=this.lastShapeId=null;},_drawShape:function(g,j,h,b,f){var c=this._getContext(h,b,f),a=this.rtl?-0.5:0.5,e,d;c.beginPath();c.moveTo(j[0][0]+a,j[0][1]+0.5);for(e=1,d=j.length;e<d;e++){c.lineTo(j[e][0]+a,j[e][1]+0.5);}if(h!=null){c.stroke();}if(b!=null){c.fill();
}if(this.targetX!=null&&this.targetY!=null&&c.isPointInPath(this.targetX,this.targetY)){this.currentTargetShapeId=g;}},_drawCircle:function(f,c,h,b,e,g,a){var d=this._getContext(e,g,a);d.beginPath();d.arc(c,h,b,0,2*Math.PI,false);if(this.targetX!=null&&this.targetY!=null&&d.isPointInPath(this.targetX,this.targetY)){this.currentTargetShapeId=f;
}if(e!=null){d.stroke();}if(g!=null){d.fill();}},_drawPieSlice:function(e,i,g,d,f,c,h,b){var a=this._getContext(h,b);a.beginPath();a.moveTo(i,g);a.arc(i,g,d,f,c,false);a.lineTo(i,g);a.closePath();if(h!=null){a.stroke();}if(b){a.fill();}if(this.targetX!==undefined&&this.targetY!==undefined&&a.isPointInPath(this.targetX,this.targetY)){this.currentTargetShapeId=e;
}},_drawRect:function(e,b,g,c,a,d,f){return this._drawShape(e,[[b,g],[b+c,g],[b+c,g+a],[b,g+a],[b,g]],d,f);},appendShape:function(a){this.shapes[a.id]=a;this.shapeseq.push(a.id);this.lastShapeId=a.id;return a.id;},replaceWithShape:function(c,a){var d=this.shapeseq,b;this.shapes[a.id]=a;for(b=d.length;
b--;){if(d[b]===c){d[b]=a.id;}}delete this.shapes[c];},replaceWithShapes:function(c,b){var g=this.shapeseq,e={},a,d,f;for(d=c.length;d--;){e[c[d]]=true;}for(d=g.length;d--;){a=g[d];if(e[a]){g.splice(d,1);delete this.shapes[a];f=d;}}for(d=b.length;d--;){g.splice(f,0,b[d].id);this.shapes[b[d].id]=b[d];
}},insertAfterShape:function(c,a){var d=this.shapeseq,b;for(b=d.length;b--;){if(d[b]===c){d.splice(b+1,0,a.id);this.shapes[a.id]=a;return;}}},removeShapeId:function(b){var c=this.shapeseq,a;for(a=c.length;a--;){if(c[a]===b){c.splice(a,1);break;}}delete this.shapes[b];},getShapeAt:function(a,b){if(this.rtl){a=this.el.dom.width-a-1;
}this.targetX=a;this.targetY=b;this.render();return this.currentTargetShapeId;},render:function(){var g=this.shapeseq,a=this.shapes,e=g.length,d=this._getContext(),f,b,c;d.clearRect(0,0,this.pixelWidth,this.pixelHeight);for(c=0;c<e;c++){f=g[c];b=a[f];this["_draw"+b.type].apply(this,b.args);}if(!this.interact){this.shapes={};
this.shapeseq=[];}}});