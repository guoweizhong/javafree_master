Ext.define("Ext.mixin.Keyboard",function(a){return{extend:"Ext.Mixin",mixinConfig:{id:"keyboard"},config:{keyMap:{$value:null,cached:true,merge:function(d,b,j,h){if(d===null){return d;}var c=(b&&!j.isInstance)?Ext.Object.chain(b):{},e,g,f,i;for(e in d){if(e!=="scope"){g=e.toUpperCase();if(!h||c[g]===undefined){f=d[e];
if(f){if(typeof f==="string"||typeof f==="function"){f={handler:f};}else{f=Ext.apply({handler:f.fn},f);}i=f.scope||d.scope||"self";f.scope=(i==="controller")?"self.controller":i;}c[g]=f;}}}return c;}},keyMapEnabled:null},keyMapTarget:"el",applyKeyMap:function(e,d){var c=this,b=c.hasOwnProperty("config");
if(b&&d&&d.$owner!==c){d=Ext.apply({},d);}e=e?a.combineKeyMaps(d,e,b&&c):null;if(c._keyMapReady){c.setKeyMapListener(e&&c.getKeyMapEnabled());}return e;},initKeyMap:function(){var c=this,b=c.getKeyMapEnabled();c._keyMapReady=true;if(b===null){c.setKeyMapEnabled(true);}else{c.setKeyMapListener(b&&c.getKeyMap());
}},disableKeyMapGroup:function(b){this.setKeyMapGroupEnabled(b,false);},enableKeyMapGroup:function(b){this.setKeyMapGroupEnabled(b,true);},setKeyMapGroupEnabled:function(e,d){var c=this,b=c.disabledKeyMapGroups||(c.disabledKeyMapGroups={});b[e]=!d;},updateKeyMapEnabled:function(b){this.setKeyMapListener(b&&this._keyMapReady&&this.getKeyMap());
},privates:{_keyMapListenCount:0,_keyMapReady:false,comparePriorities:function(b,c){return(c.priority||0)-(b.priority||0);},findKeyMapEntries:function(h){var j=this,d=j.disabledKeyMapGroups,g=j.getKeyMap(),c=g&&a.getKeyName(h),k,f,b,l=[];c=c&&g[c];if(c){if(!c.sorted){Ext.Array.sort(c,j.comparePriorities);
c.sorted=true;}f=c.length;for(b=0;b<f;b++){k=c[b];if(!d||!d[k.group]){if(a.matchEntry(k,h)){l.push(k);}}}}return l;},onKeyMapEvent:function(j){var h=this,d=h.getKeyMapEnabled()?h.findKeyMapEntries(j):null,c=d&&d.length,f,g,b;for(f=0;f<c&&b!==false;f++){g=d[f];b=Ext.callback(g.handler,g.scope,[j,this],0,this);
}return b;},setKeyMapListener:function(b){var c=this,e=c._keyMapListener,d;if(e){e.destroy();e=null;}if(b){++c._keyMapListenCount;if(b){d=c[c.keyMapTarget];if(typeof d==="function"){d=d.call(c);}e=d.on({destroyable:true,scope:c,keydown:"onKeyMapEvent",keypress:"onKeyMapEvent"});}}c._keyMapListener=e||null;
},statics:{_charCodeRe:/^#([\d]+)$/,_keySpecRe:/^(?:(?:(\*)[\+\-])|(?:([a-z\+\-]*)[\+\-]))?(?:([a-z0-9_]+|[\+\-]|(?:#?\d+))(?:\:([a-z]+))?)$/i,_delimiterRe:/\-|\+/,_keyMapEvents:{charCode:"keypress",keyCode:"keydown"},combineKeyMaps:function(g,i,b){var h=i.scope||"controller",e,d,c,f;for(d in i){if(d==="scope"){continue;
}if(!(c=i[d])){if(c===undefined){Ext.raise('keyMap entry "'+d+'" is undefined');}if(!g){continue;}}else{if(typeof c==="string"||typeof c==="function"){c={handler:c,scope:h};}else{if(c){c=Ext.apply({handler:c.fn,scope:h},c);}}g=g||{};}if(a.parseEntry(d,e=c||{})){f=g[e.name];if(f){if(b&&f.$owner!==b){g[e.name]=f=f.slice();
f.$owner=b;}f.push(c);f.sorted=false;}else{f=g[e.name]=[c];f.$owner=b;f.sorted=true;}}else{Ext.raise('Invalid keyMap key specification "'+d+'"');}}if(g&&b){g.$owner=b;}return g||null;},getKeyName:function(c){var b=c.isEvent?c.keyCode||c.charCode:c;return Ext.event.Event.keyCodes[b]||String.fromCharCode(b);
},matchEntry:function(d,f){var c=f.browserEvent,b;if(f.type!==d.event){return false;}if(!(b=d.charCode)){if(d.keyCode!==f.keyCode||(!d.ignoreModifiers&&!d.shiftKey!==!c.shiftKey)){return false;}}else{if(f.getCharCode()!==b){return false;}}return d.ignoreModifiers||(!d.ctrlKey===!c.ctrlKey&&!d.altKey===!c.altKey&&!d.metaKey===!c.metaKey&&!d.shiftKey===!c.shiftKey);
},parseEntry:function(m,l){m=m.toUpperCase();var h=this,o=Ext.event.Event,k=o.keyFlags,e=h._keySpecRe.exec(m),j="keyCode",b,c,f,g,d;if(e){b=e[3];if(e[4]){l.group=e[4];}if(!(l.ignoreModifiers=!!e[1])&&e[2]){e=e[2].split(h._delimiterRe);d=e.length;for(f=0;f<d;f++){if(!k[e[f]]){return false;}l[k[e[f]]]=true;
}}l.name=b;if(isNaN(c=o[b])){if(!(g=h._charCodeRe.exec(b))){if(b.length===1){c=b.charCodeAt(0);}}else{c=+g[1];}if(c){j="charCode";}else{c=+b;}l.name=a.getKeyName(c);}l.event=l.event||h._keyMapEvents[j];return !isNaN(c)&&(l[j]=c);}}}}};});