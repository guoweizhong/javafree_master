Ext.define("Ext.util.SorterCollection",{extend:"Ext.util.Collection",requires:["Ext.util.Sorter"],isSorterCollection:true,$sortable:null,sortFn:null,config:{sorterOptionsFn:null,sorterOptionsScope:null},constructor:function(a){var b=this;b.sortFn=Ext.util.Sorter.createComparator(b);b.callParent([a]);
b.setDecoder(b.decodeSorter);},addSort:function(i,h,c){var g=this,d,e,b,k,a,j,f;if(!i){g.beginUpdate();g.endUpdate();}else{k=g.getOptions();if(i instanceof Array){f=i;c=h;h=null;}else{if(Ext.isString(i)){if(!(j=g.get(i))){f=[{property:i,direction:h||k.getDefaultSortDirection()}];}else{f=[j];}}else{if(Ext.isFunction(i)){f=[{sorterFn:i,direction:h||k.getDefaultSortDirection()}];
}else{if(!Ext.isObject(i)){Ext.raise("Invalid sort descriptor: "+i);}f=[i];c=h;h=null;}}}if(c&&!g._sortModes[c]){Ext.raise('Sort mode should be "multi", "append", "prepend" or "replace", not "'+c+'"');}c=g._sortModes[c||"replace"];a=g.getAt(0);d=g.length;e=c.append?d:0;g.beginUpdate();g.splice(e,c.replace?d:0,f);
if(c.multi){d=g.length;b=k.getMultiSortLimit();if(d>b){g.removeAt(b,d);}}if(j&&h){j.setDirection(h);}else{if(e===0&&a&&a===g.getAt(0)){a.toggle();}}g.endUpdate();}},clear:function(){this.beginUpdate();this.callParent();this.endUpdate(this.items);},getSortFn:function(){return this.sortFn;},getByProperty:function(e){var b=this.items,a=b.length,c,d;
for(c=0;c<a;++c){d=b[c];if(d.getProperty()===e){return d;}}return null;},_sortModes:{append:{append:1},multi:{multi:1},prepend:{prepend:1},replace:{replace:1}},decodeSorter:function(h,a){var f=this,i=f.getOptions(),g=i.getRootProperty(),b=f.getSorterOptionsFn(),c,e,d;if(h.isSorter){if(!h.getRoot()){h.setRoot(g);
}}else{e={direction:i.getDefaultSortDirection(),root:g};d=typeof h;if(d==="string"){c=f.get(h);if(c){return c;}e.property=h;}else{if(d==="function"){e.sorterFn=h;}else{if(!Ext.isObject(h)){Ext.raise("Invalid sorter specified: "+h);}e=Ext.apply(e,h);if(e.fn){e.sorterFn=e.fn;delete e.fn;}}}h=Ext.create(a||Ext.util.Sorter,e);
}if(b){b.call(f.getSorterOptionsScope()||f,h);}return h;},setSorterConfigure:function(b,a){this.setSorterOptionsFn(b);this.setSorterOptionsScope(a);},decodeRemoveItems:function(g,d){var j=this,e=(d===undefined)?g:g[d];if(!e||!e.$cloned){if(g.length>d+1||!Ext.isIterable(e)){e=Ext.Array.slice(g,d);}var k=j.items,f=e.length,c=[],b,l,a,m,h;
for(b=0;b<f;b++){m=e[b];if(m&&m.isSorter){c.push(m);}else{h=typeof m;if(h==="string"){m=j.get(m);if(m){c.push(m);}}else{if(h==="function"){for(a=k.length;a-->0;){l=k[a];if(l.getSorterFn()===m){c.push(l);}}}else{Ext.raise("Invalid sorter specification: "+m);}}}}e=c;e.$cloned=true;}return e;},getOptions:function(){return this.$sortable||this;
}});