Ext.define("Ext.util.Collection",{mixins:["Ext.mixin.Observable"],requires:["Ext.util.CollectionKey","Ext.util.Filter","Ext.util.Sorter","Ext.util.Grouper"],uses:["Ext.util.SorterCollection","Ext.util.FilterCollection","Ext.util.GroupCollection"],isCollection:true,config:{autoFilter:true,autoSort:true,autoGroup:true,decoder:null,extraKeys:null,filters:null,grouper:null,groups:null,groupConfig:null,rootProperty:null,sorters:null,multiSortLimit:3,defaultSortDirection:"ASC",source:null,trackGroups:true},generation:0,indices:null,indexRebuilds:0,updating:0,grouped:false,sorted:false,filtered:false,$endUpdatePriority:1001,manageSorters:true,constructor:function(a){var b=this;
b.callParent([a]);b.items=[];b.map={};b.length=0;if(a&&a.keyFn){b.getKey=a.keyFn;}b.mixins.observable.constructor.call(b,a);},destroy:function(){var c=this,b=c._filters,d=c._sorters,a=c._groups;if(b){b.destroy();c._filters=null;}if(d){c.grouped=c.sorted=false;c.setSorters(null);if(c.manageSorters){d.destroy();
}}if(a){a.destroy();c._groups=null;}c.setSource(null);c.observers=c.items=c.map=null;c.callParent();},add:function(d){var c=this,a=c.decodeItems(arguments,0),b=a;if(a.length){c.splice(c.length,0,a);b=(a.length===1)?a[0]:a;}return b;},replaceAll:function(){var c=this,b,a;a=c.decodeItems(arguments,0);b=a;
if(a.length){c.splice(0,c.length,a);b=(a.length===1)?a[0]:a;}else{c.removeAll();}return b;},aggregate:function(g,b,e,a,d){var f=this,c=Ext.Array.slice(arguments);c.unshift(f.items);return f.aggregateItems.apply(f,c);},aggregateByGroup:function(d,b,c){var a=this.getGroups();return this.aggregateGroups(a,d,b,c);
},aggregateItems:function(k,q,d,a,e,r){var l=this,h=Ext.Number.clipIndices(k.length,[a,e]),b=(a!==0&&e!==k.length),g,f,c,m,o,p,n;a=h[0];e=h[1];if(!Ext.isFunction(d)){d=l._aggregators[d];return d.call(l,k,a,e,q,l.getRootProperty());}m=l.getRootProperty();p=new Array(c);n=b?new Array(c):k;for(g=a,f=0;g<e;
++g,f++){if(b){n[f]=o=k[g];}p[f]=(m?o[m]:o)[q];}return d.call(r||l,k,p,0);},aggregateGroups:function(a,j,c,k){var g=a.items,f=g.length,b=!Ext.isFunction(c),d={},e,h,l;for(e=0;e<f;++e){h=g[e];if(!b){l=this.aggregateItems(h.items,j,c,null,null,k);}else{l=h[c](j);}d[h.getGroupKey()]=l;}return d;},beginUpdate:function(){if(!this.updating++){this.notify("beginupdate");
}},clear:function(){var c=this,d=c.generation,a=d?c.items:[],b,e;if(d){c.items.length=c.length=0;c.map={};c.indices={};c.generation++;b=c.getExtraKeys();if(b){for(e in b){b[e].clear();}}}return a;},clone:function(){var a=this,b=new a.self(a.initialConfig);b.add(a.items);return b;},collect:function(k,f,h){var e=this.items,b=e.length,a={},d=[],c,g,j;
for(c=0;c<b;++c){j=e[c];j=(f?j[f]:j)[k];g=String(j);if((h||!Ext.isEmpty(j))&&!a[g]){a[g]=1;d.push(j);}}return d;},contains:function(c){var a=false,b;if(c!=null){b=this.getKey(c);a=this.map[b]===c;}return a;},containsKey:function(a){return a in this.map;},createFiltered:function(n,m,e,j,d){var h=this,f=new h.self(h.initialConfig),l=h.getRootProperty(),g=h.items,b,c,a,k,o;
if(Ext.isFunction(n)){k=n;o=m;}else{if(Ext.isString(n)){a=[new Ext.util.Filter({property:n,value:m,root:l,anyMatch:e,caseSensitive:j,exactMatch:d})];}else{if(n instanceof Ext.util.Filter){a=[n];n.setRoot(l);}else{if(Ext.isArray(n)){a=n.slice(0);for(c=0,b=a.length;c<b;++c){a[c].setRoot(l);}}}}k=Ext.util.Filter.createFilterFn(a);
}o=o||h;for(c=0,b=g.length;c<b;c++){if(k.call(o,g[c])){f.add(g[c]);}}return f;},filterBy:function(b,a){return this.createFiltered(b,a);},each:function(f,e){var b=this.items,a=b.length,d,c;if(a){e=e||this;b=b.slice(0);for(d=0;d<a;d++){c=f.call(e,b[d],d,a);if(c===false){break;}}}return c;},eachKey:function(f,j){var e=this,d=e.items,b=d.length,a,h,g,c;
if(b){j=j||e;d=d.slice(0);for(a=0;a<b;a++){g=e.getKey(h=d[a]);c=f.call(j,g,h,a,b);if(c===false){break;}}}return c;},endUpdate:function(){if(!--this.updating){this.notify("endupdate");}},find:function(g,f,h,d,c,b){if(Ext.isEmpty(f,false)){return null;}var e=Ext.String.createRegex(f,d,c,b),a=this.getRootProperty();
return this.findBy(function(i){return i&&e.test((a?i[a]:i)[g]);},null,h);},findBy:function(f,j,a){var e=this,d=e.items,c=d.length,b,h,g;j=j||e;for(b=a||0;b<c;b++){g=e.getKey(h=d[b]);if(f.call(j,h,g)){return d[b];}}return null;},findIndex:function(f,e,g,c,b,a){var d=this.find(f,e,g,c,b,a);return d?this.indexOf(d):-1;
},findIndexBy:function(b,a,d){var c=this.findBy(b,a,d);return c?this.indexOf(c):-1;},first:function(b){var a=b?this.getGroups():undefined;return a?this.aggregateGroups(a,null,"first"):this.items[0];},last:function(b){var a=b?this.getGroups():undefined;return a?this.aggregateGroups(a,null,"last"):this.items[this.length-1];
},get:function(a){return this.map[a];},getAt:function(a){return this.items[a];},getByKey:function(a){return this.map[a];},getCount:function(){return this.length;},getKey:function(a){var b=a.id;return(b===0||b)?b:((b=a._id)===0||b)?b:a.getId();},getRange:function(d,a){var c=this.items,e=c.length,b;if(d>a){Ext.raise("Inverted range passed to Collection.getRange: ["+d+","+a+"]");
}if(!e){b=[];}else{b=Ext.Number.clipIndices(e,[d,a]);b=c.slice(b[0],b[1]);}return b;},getValues:function(j,g,a,b){var f=this.items,d=Ext.Number.clipIndices(f.length,[a,b]),e=[],c,h;for(c=d[0],b=d[1];c<b;++c){h=f[c];h=(g?h[g]:h)[j];e.push(h);}return e;},indexOf:function(b){if(!b){return -1;}var a=this.getKey(b);
return this.indexOfKey(a);},indexOfKey:function(a){var b=this,c=b.indices;if(a in b.map){if(!c){c=b.getIndices();}return c[a];}return -1;},insert:function(c,e){var d=this,a=d.decodeItems(arguments,1),b=a;if(a.length){d.splice(c,0,a);b=(a.length===1)?a[0]:a;}return b;},itemChanged:function(t,h,l,m){var u=this,c=l!==undefined,i=u.filtered&&u.getAutoFilter(),e=false,d=0,o=u.items,k=u.length-1,a=u.sorted&&k>0&&u.getAutoSort(),q=u.getSource(),p=0,j=false,n=false,s,r,f,v,g,b;
if(q&&!q.updating){u.sourceUpdating=true;q.itemChanged(t,h,l,m);u.sourceUpdating=false;}else{r=u.getKey(t);if(i){g=u.indexOfKey(c?l:r);n=(g<0);j=u.isItemFiltered(t);e=(n!==j);}if(e){if(j){p=[t];b=-1;}else{v=[t];b=u.length;}}else{if(a&&!j){if(!i){g=u.indexOfKey(c?l:r);}f=u.getSortFn();if(g!==-1){if(g&&f(o[g-1],o[g])>0){d=-1;
b=Ext.Array.binarySearch(o,t,0,g,f);}else{if(g<k&&f(o[g],o[g+1])>0){d=1;b=Ext.Array.binarySearch(o,t,g+1,f);}}if(d){v=[t];}}}}s={item:t,key:r,index:b,filterChanged:e,keyChanged:c,indexChanged:!!d,filtered:j,oldIndex:g,newIndex:b,wasFiltered:n,meta:m};if(c){s.oldKey=l;}if(h){s.modified=h;}++u.generation;
u.beginUpdate();u.notify("beforeitemchange",[s]);if(c){u.updateKey(t,l,s);}if(v||p){u.splice(b,p,v);}if(d>0){s.newIndex--;}else{if(d<0){s.oldIndex++;}}u.notify(j?"filtereditemchange":"itemchange",[s]);u.endUpdate();}},remove:function(d){var c=this,a=c.decodeRemoveItems(arguments,0),b=c.length;c.splice(0,a);
return b-c.length;},removeAll:function(){var b=this,a=b.length;if(b.generation&&a){b.splice(0,a);}return b;},removeAt:function(h,g){var i=this,b=i.length,e=Ext.Number,d=e.clipIndices(b,[h,(g===undefined)?1:g],e.Clip.COUNT),c=d[0],a=d[1]-c,j=(a===1)&&i.getAt(c),f;i.splice(c,a);f=i.length-b;return(j&&f)?j:f;
},removeByKey:function(a){var b=this.getByKey(a);if(!b||!this.remove(b)){return false;}return b;},replace:function(b){var a=this.indexOf(b);if(a===-1){this.add(b);}else{this.insert(a,b);}},splice:function(D,m,B){var l=this,d=l.sorted&&l.getAutoSort(),z=l.map,r=l.items,p=l.length,v=(m instanceof Array)?l.decodeRemoveItems(m):null,w=!v,E=Ext.Number,e=E.clipIndices(p,[D,w?m:0],E.Clip.COUNT),g=e[0],j=e[1],K=j-g,t=l.decodeItems(arguments,2),J=t?t.length:0,C,x,u,c=g,b=l.indices||((J||v)?l.getIndices():null),q=null,h=K?[g]:null,f=null,s=l.getSource(),a,G,H,M,A,F,L,o,y,I,O,N;
if(s&&!s.updating){if(w){v=[];for(M=0;M<K;++M){v.push(r[g+M]);}}if(g<p){M=s.indexOf(r[g]);}else{M=s.length;}l.requestedIndex=D;s.splice(M,v,t);delete l.requestedIndex;return l;}if(J){C=t;f=[];x={};if(d){N=l.getSorters();if(J>1){if(!C.$cloned){t=C=C.slice(0);}l.sortData(C);}}for(M=0;M<J;++M){o=l.getKey(A=t[M]);
if((L=x[o])!==undefined){(O||(O={}))[L]=1;}else{F=b[o];if(F<g||j<=F){(h||(h=[])).push(F);}}x[o]=M;f.push(o);}if(O){y=f;C=[];f=[];C.$cloned=true;for(M=0;M<J;++M){if(!O[M]){A=t[M];C.push(A);f.push(y[M]);}}J=C.length;}q={items:C,keys:f};}for(M=v?v.length:0;M-->0;){o=l.getKey(v[M]);if((F=b[o])!==undefined){(h||(h=[])).push(F);
}}if(!q&&!h){return l;}l.beginUpdate();if(h){a=null;H=[];u={};if(h.length>1){h.sort(Ext.Array.numericSortFn);}for(M=0,I=h.length;M<I;++M){o=l.getKey(A=r[F=h[M]]);if(!(o in z)){continue;}delete z[o];if(!a||F>(a.at+G.length)){H.push(a={at:F,items:(G=[]),keys:(y=[]),map:u,next:a,replacement:q});if(q){q.replaced=a;
}}G.push(u[o]=A);y.push(o);if(F<c-1){--c;}if(K>1&&F===g){--K;h[M--]=++g;}}if(q){q.at=c;}for(L=H.length;L-->0;){a=H[L];M=a.at;I=a.items.length;if(M+I<p){l.indices=b=null;}l.length=p-=I;r.splice(M,I);if(b){y=a.keys;for(M=0;M<I;++M){delete b[y[M]];}}++l.generation;l.notify("remove",[a]);}}if(q){if(d&&J>1&&p){l.spliceMerge(C,f);
}else{if(d){if(J>1){c=0;l.indices=b=null;}else{c=N.findInsertionIndex(q.items[0],r,l.getSortFn(),D);}}if(c===p){j=c;for(M=C.length-1;M>=0;--M){r[j+M]=C[M];}b=l.indices;if(b){for(M=0;M<J;++M){b[f[M]]=c+M;}}}else{l.indices=null;Ext.Array.insert(r,c,C);}for(M=0;M<J;++M){z[f[M]]=C[M];}l.length+=J;q.at=c;
q.atItem=c===0?null:r[c-1];++l.generation;l.notify("add",[q]);}}l.endUpdate();return l;},update:function(b,a){var c=this;c.beginUpdate();try{return b.call(a||c,c);}catch(d){Ext.log.error(this.$className+": Unhandled Exception: ",d.description||d.message);throw d;}finally{c.endUpdate();}},updateKey:function(c,f,a){var b=this,e=b.map,h=b.indices,d=b.getSource(),g;
if(d&&!d.updating){d.updateKey(c,f);}else{if((g=b.getKey(c))!==f){if(e[f]===c&&!(g in e)){delete e[f];b.updating++;b.generation++;e[g]=c;if(h){h[g]=h[f];delete h[f];}b.notify("updatekey",[Ext.apply({item:c,newKey:g,oldKey:f},a)]);b.updating--;}else{if(g in e&&e[g]!==c){Ext.raise('Duplicate newKey "'+g+'" for item with oldKey "'+f+'"');
}if(f in e&&e[f]!==c){Ext.raise('Incorrect oldKey "'+f+'" for item with newKey "'+g+'"');}}}}},findInsertIndex:function(d){var e=this.getSource(),f=e.items,b=e.indexOf(d)-1,c,a;while(b>-1){c=f[b];a=this.indexOf(c);if(a>-1){return a+1;}--b;}return 0;},onCollectionAdd:function(a,b){var k=this,m=b.atItem,j=b.items,f=k.requestedIndex,h,g,c,e,l,d;
if(!k.sorted){if(f!==undefined){g=f;}else{if(m){g=k.indexOf(m);if(g===-1){g=k.findInsertIndex(j[0]);}else{++g;}}else{g=0;}}}if(k.getAutoFilter()&&k.filtered){for(e=0,d=j.length;e<d;++e){l=j[e];if(k.isItemFiltered(l)){if(!c){c=j.slice(0,e);}if(!h){h=[];}h.push(l);}else{if(c){c.push(l);}}}}k.splice((g<0)?k.length:g,0,c||j);
if(h){k.notify("filteradd",[h]);}},onCollectionBeforeItemChange:function(b,a){this.onCollectionUpdateKey=null;if(!this.sourceUpdating){this.notify("beforeitemchange",[a]);}},onCollectionBeginUpdate:function(){this.beginUpdate();},onCollectionEndUpdate:function(){this.endUpdate();},onCollectionItemChange:function(b,a){delete this.onCollectionUpdateKey;
this.itemChanged(a.item,a.modified,a.oldKey,a.meta);},onCollectionFilteredItemChange:function(){delete this.onCollectionUpdateKey;},onCollectionRefresh:function(a){var h=this,b={},k={},g=h.items,f=a.items,m=h.getFilterFn(),e,l,j,c,d;if(h.filtered&&h.getAutoFilter()){for(e=0,d=0,c=f.length;e<c;e++){if(m(f[e])){g[d++]=f[e];
}}g.length=d;}else{g.length=0;g.push.apply(g,f);}if(h.sorted){h.sortData(g);}h.length=c=g.length;h.map=b;h.indices=k;for(e=0;e<c;++e){j=h.getKey(l=g[e]);b[j]=l;k[j]=e;}++h.generation;h.notify("refresh");},onCollectionRemove:function(b,a){this.splice(0,a.items);},onCollectionUpdateKey:function(b,a){this.updateKey(a.item,a.oldKey,a);
},_aggregators:{average:function(c,d,b,e,a){var f=b-d;return f&&this._aggregators.sum.call(this,c,d,b,e,a)/f;},bounds:function(e,a,b,j,f){for(var h,g,c,d=a;d<b;++d){h=e[d];h=(f?h[f]:h)[j];if(!(h<g)){g=h;}if(!(h>c)){c=h;}}return[c,g];},count:function(a){return a.length;},extremes:function(f,a,c,l,j){var g=null,b=null,e,m,h,d,k;
for(e=a;e<c;++e){m=f[e];k=(j?m[j]:m)[l];if(!(k<h)){h=k;g=m;}if(!(k>d)){d=k;b=m;}}return[b,g];},max:function(e,f,d,g,c){var a=this._aggregators.bounds.call(this,e,f,d,g,c);return a[1];},maxItem:function(e,f,d,g,c){var a=this._aggregators.extremes.call(this,e,f,d,g,c);return a[1];},min:function(e,f,d,g,c){var a=this._aggregators.bounds.call(this,e,f,d,g,c);
return a[0];},minItem:function(e,f,d,g,c){var a=this._aggregators.extremes.call(this,e,f,d,g,c);return a[0];},sum:function(c,f,b,h,a){for(var g,e=0,d=f;d<b;++d){g=c[d];g=(a?g[a]:g)[h];e+=g;}return e;}},_eventToMethodMap:{add:"onCollectionAdd",beforeitemchange:"onCollectionBeforeItemChange",beginupdate:"onCollectionBeginUpdate",endupdate:"onCollectionEndUpdate",itemchange:"onCollectionItemChange",filtereditemchange:"onCollectionFilteredItemChange",refresh:"onCollectionRefresh",remove:"onCollectionRemove",beforesort:"beforeCollectionSort",sort:"onCollectionSort",filter:"onCollectionFilter",filteradd:"onCollectionFilterAdd",updatekey:"onCollectionUpdateKey"},addObserver:function(a){var b=this,c=b.observers;
if(!c){b.observers=c=[];}if(Ext.Array.contains(c,a)){Ext.Error.raise("Observer already added");}if(b.notifying){b.observers=c=c.slice(0);}c.push(a);if(c.length>1){Ext.Array.sort(c,b.prioritySortFn);}},prioritySortFn:function(f,e){var d=f.observerPriority||0,c=e.observerPriority||0;return d-c;},applyExtraKeys:function(e,a){var f=this,d=a||{},c,b,g;
for(b in e){g=e[b];if(!g.isCollectionKey){c={collection:f};if(Ext.isString(g)){c.property=g;}else{c=Ext.apply(c,g);}g=new Ext.util.CollectionKey(c);}else{g.setCollection(f);}d[b]=f[b]=g;g.name=b;}return d;},applyGrouper:function(a){if(a){a=this.getSorters().decodeSorter(a,Ext.util.Grouper);}return a;
},decodeItems:function(d,c){var f=this,b=(c===undefined)?d:d[c],a,g,e;if(!b||!b.$cloned){a=d.length>c+1||!Ext.isIterable(b);if(a){b=Ext.Array.slice(d,c);if(b.length===1&&b[0]===undefined){b.length=0;}}g=f.getDecoder();if(g){if(!a){b=b.slice(0);a=true;}for(e=b.length;e-->0;){if((b[e]=g.call(f,b[e]))===false){b.splice(e,1);
}}}if(a){b.$cloned=true;}}return b;},getIndices:function(){var d=this,e=d.indices,a=d.items,f=a.length,c,b;if(!e){d.indices=e={};++d.indexRebuilds;for(c=0;c<f;++c){b=d.getKey(a[c]);e[b]=c;}}return e;},notify:function(d,g){var h=this,c=h.observers,j=h._eventToMethodMap[d],i=0,e,b,a,f;g=g||[];if(c&&j){h.notifying=true;
for(e=0,b=c.length;e<b;++e){a=(f=c[e])[j];if(a){if(!i++){g.unshift(h);}a.apply(f,g);}}h.notifying=false;}if(!h.hasListeners){return;}if(h.hasListeners[d]){if(!i){g.unshift(h);}h.fireEventArgs(d,g);}},getFilterFn:function(){return this.getFilters().getFilterFn();},getFilters:function(b){var a=this._filters;
if(!a&&b!==false){a=new Ext.util.FilterCollection();this.setFilters(a);}return a;},isItemFiltered:function(a){return !this.getFilters().filterFn(a);},onFilterChange:function(e){var d=this,f=d.getSource(),c,b,a;if(!f){c=d.getExtraKeys();if(c){b={};for(a in c){b[a]=c[a].clone(d);}}f=new Ext.util.Collection({keyFn:d.getKey,extraKeys:b,rootProperty:d.getRootProperty()});
if(d.length){f.add(d.items);}d.setSource(f);d.autoSource=f;}else{if(f.length||d.length){d.onCollectionRefresh(f);}}d.notify("filter");},applyFilters:function(a,b){if(!a||a.isFilterCollection){return a;}if(a){if(!b){b=this.getFilters();}b.splice(0,b.length,a);}return b;},updateFilters:function(a,b){var c=this;
if(b){b.un("endupdate","onEndUpdateFilters",c);}if(a){a.on({endupdate:"onEndUpdateFilters",scope:c,priority:c.$endUpdatePriority});a.$filterable=c;}c.onEndUpdateFilters(a);},onEndUpdateFilters:function(c){var b=this,d=b.filtered,a=!!c&&(c.getFilterCount()>0);if(d||a){b.filtered=a;b.onFilterChange(c);
}},getSortFn:function(){return this._sortFn||this.createSortFn();},getSorters:function(b){var a=this._sorters;if(!a&&b!==false){a=new Ext.util.SorterCollection();this.setSorters(a);}return a;},onSortChange:function(){if(this.sorted){this.sortItems();}},sort:function(a,c,d){var b=this.getSorters();b.addSort.apply(b,arguments);
return this;},sortData:function(a){Ext.Array.sort(a,this.getSortFn());return a;},sortItems:function(b){var a=this;if(a.sorted){if(b){Ext.raise("Collections with sorters cannot resorted");}b=a.getSortFn();}a.indices=null;a.notify("beforesort",[a.getSorters(false)]);if(a.length){Ext.Array.sort(a.items,b);
}a.notify("sort");},sortBy:function(a){return this.sortItems(a);},findInsertionIndex:function(d,a,c,b){return Ext.Array.findInsertionIndex(d,a||this.items,c||this.getSortFn(),b);},applySorters:function(a,b){if(!a||a.isSorterCollection){return a;}if(a){if(!b){b=this.getSorters();}b.splice(0,b.length,a);
}return b;},createSortFn:function(){var c=this,a=c.getGrouper(),d=c.getSorters(false),b=d?d.getSortFn():null;if(!a){return b;}return function(e,g){var f=a.sort(e,g);if(!f&&b){f=b(e,g);}return f;};},updateGrouper:function(b){var c=this,a=c.getGroups(),e=c.getSorters(),d;c.onSorterChange();c.grouped=!!b;
if(b){if(c.getTrackGroups()){if(!a){a=new Ext.util.GroupCollection({itemRoot:c.getRootProperty(),groupConfig:c.getGroupConfig()});a.$groupable=c;c.setGroups(a);}a.setGrouper(b);d=true;}}else{if(a){c.removeObserver(a);a.destroy();}c.setGroups(null);}if(!e.updating){c.onEndUpdateSorters(e);}if(d){a.onCollectionRefresh(c);
}},updateSorters:function(a,b){var c=this;if(b&&!b.destroyed){b.un("endupdate","onEndUpdateSorters",c);}if(a){a.on({endupdate:"onEndUpdateSorters",scope:c,priority:c.$endUpdatePriority});if(c.manageSorters){a.$sortable=c;}}c.onSorterChange();c.onEndUpdateSorters(a);},onSorterChange:function(){this._sortFn=null;
},onEndUpdateSorters:function(c){var b=this,d=b.sorted,a=(b.grouped&&b.getAutoGroup())||(c&&c.length>0);if(d||a){b.sorted=!!a;b.onSortChange(c);}},removeObserver:function(a){var b=this.observers;if(b){Ext.Array.remove(b,a);}},spliceMerge:function(j,r){var q=this,p=q.map,f=j.length,c=0,k=q.items,s=k.length,h=[],g=0,m=[],d=q.getSortFn(),l,b,n,e,o,a;
q.items=m;for(a=0;a<f;a=b){e=j[a];for(;c<s;++c){if(d(e,o=k[c])<0){break;}m.push(o);}if(c===s){h[g++]={at:m.length,itemAt:m[m.length-1],items:(l=[])};if(g>1){h[g-2].next=h[g-1];}for(;a<f;++a){l.push(e=j[a]);m.push(e);}break;}h[g++]={at:m.length,itemAt:m[m.length-1],items:(l=[e])};if(g>1){h[g-2].next=h[g-1];
}m.push(e);for(b=a+1;b<f;++b){if(d(e=j[b],o)>=0){break;}m.push(e);l.push(e);}}for(;c<s;++c){m.push(k[c]);}for(n=0;n<f;++n){p[r[n]]=j[n];}q.length=m.length;++q.generation;q.indices=null;for(n=0;n<g;++n){q.notify("add",[h[n]]);}},getGroups:function(){return this.callParent()||null;},updateAutoGroup:function(b){var a=this.getGroups();
if(a){a.setAutoGroup(b);}this.onEndUpdateSorters(this._sorters);},updateGroups:function(a,b){if(b){this.removeObserver(b);}if(a){this.addObserver(a);}},updateSource:function(b,a){var c=this.autoSource;if(a){if(!a.destroyed){a.removeObserver(this);}if(a===c){c.destroy();this.autoSource=null;}}if(b){b.addObserver(this);
if(b.length||this.length){this.onCollectionRefresh(b);}}}},function(){var a=this.prototype;a.removeAtKey=a.removeByKey;a.decodeRemoveItems=a.decodeItems;Ext.Object.each(a._aggregators,function(b){a[b]=function(e,d,c){return this.aggregate(e,b,d,c);};a[b+"ByGroup"]=function(c){return this.aggregateByGroup(c,b);
};});});