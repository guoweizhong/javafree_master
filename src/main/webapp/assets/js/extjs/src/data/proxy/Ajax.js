Ext.define("Ext.data.proxy.Ajax",{requires:["Ext.Ajax"],extend:"Ext.data.proxy.Server",alias:"proxy.ajax",alternateClassName:["Ext.data.HttpProxy","Ext.data.AjaxProxy"],isAjaxProxy:true,defaultActionMethods:{create:"POST",read:"GET",update:"POST",destroy:"POST"},config:{binary:false,headers:undefined,paramsAsJson:false,withCredentials:false,useDefaultXhrHeader:true,username:null,password:null,actionMethods:{create:"POST",read:"GET",update:"POST",destroy:"POST"}},doRequest:function(a){var d=this,e=d.getWriter(),c=d.buildRequest(a),g=d.getMethod(c),b,f;
if(e&&a.allowWrite()){c=e.write(c);}c.setConfig({binary:d.getBinary(),headers:d.getHeaders(),timeout:d.getTimeout(),scope:d,callback:d.createRequestCallback(c,a),method:g,useDefaultXhrHeader:d.getUseDefaultXhrHeader(),disableCaching:false});if(g.toUpperCase()!=="GET"&&d.getParamsAsJson()){f=c.getParams();
if(f){b=c.getJsonData();if(b){b=Ext.Object.merge({},b,f);}else{b=f;}c.setJsonData(b);c.setParams(undefined);}}if(d.getWithCredentials()){c.setWithCredentials(true);c.setUsername(d.getUsername());c.setPassword(d.getPassword());}return d.sendRequest(c);},sendRequest:function(a){a.setRawRequest(Ext.Ajax.request(a.getCurrentConfig()));
this.lastRequest=a;return a;},abort:function(a){a=a||this.lastRequest;if(a){Ext.Ajax.abort(a.getRawRequest());}},getMethod:function(a){var c=this.getActionMethods(),b=a.getAction(),d;if(c){d=c[b];}return d||this.defaultActionMethods[b];},createRequestCallback:function(b,a){return function(d,f,c){var e=this;
if(b===e.lastRequest){e.lastRequest=null;}if(!e.destroying&&!e.destroyed){e.processResponse(f,a,b,c);}};},destroy:function(){this.lastRequest=null;this.callParent();}});