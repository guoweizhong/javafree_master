Ext.define("Ext.data.proxy.Proxy",{mixins:["Ext.mixin.Factoryable","Ext.mixin.Observable"],$configPrefixed:false,alias:"proxy.proxy",alternateClassName:["Ext.data.DataProxy","Ext.data.Proxy"],requires:["Ext.data.schema.Schema","Ext.data.reader.Reader","Ext.data.writer.Writer"],uses:["Ext.data.Batch","Ext.data.operation.*","Ext.data.Model"],config:{batchOrder:"create,update,destroy",batchActions:true,model:undefined,reader:{type:"json"},writer:{type:"json"}},isProxy:true,isSynchronous:false,constructor:function(a){this.mixins.observable.constructor.call(this,a);
this.pendingOperations={};},applyModel:function(a){return Ext.data.schema.Schema.lookupEntity(a);},updateModel:function(b){if(b){var a=this.getReader();if(a&&!a.getModel()){a.setModel(b);}}},applyReader:function(a){if(this.isSynchronous){a=a||{};a.keepRawData=true;}return Ext.Factory.reader(a);},updateReader:function(a){if(a){var c=this,b=c.getModel();
if(!b){b=a.getModel();if(b){c.setModel(b);}}else{a.setModel(b);}}},applyWriter:function(b){var a=this.getReader();b=Ext.Factory.writer(b);if(b.getRecord&&!b.getRecord()&&a&&a.getRecord){a=a.getRecord();if(a){b.setRecord(a);}}return b;},abort:Ext.emptyFn,onMetaChange:function(a){this.fireEvent("metachange",this,a);
},create:Ext.emptyFn,read:Ext.emptyFn,update:Ext.emptyFn,erase:Ext.emptyFn,batch:function(n,k){var j=this,i=j.getBatchActions(),g,c,f,d,e,l,b,m,h;if(n.operations===undefined){n={operations:n,listeners:k};}if(n.batch){if(Ext.isDefined(n.batch.runOperation)){g=Ext.applyIf(n.batch,{proxy:j,listeners:{}});
}}else{n.batch={proxy:j,listeners:n.listeners||{}};}if(!g){g=new Ext.data.Batch(n.batch);}g.on("complete",Ext.bind(j.onBatchComplete,j,[n],0));f=j.getBatchOrder().split(",");d=f.length;for(l=0;l<d;l++){e=f[l];c=n.operations[e];if(c){if(i){g.add(j.createOperation(e,{records:c,params:n.params}));}else{m=c.length;
for(b=0;b<m;b++){h=c[b];g.add(j.createOperation(e,{records:[h],params:n.params}));}}}}g.start();return g;},onBatchComplete:function(a,b){var c=a.scope||this;if(b.hasException()){if(Ext.isFunction(a.failure)){Ext.callback(a.failure,c,[b,a]);}}else{if(Ext.isFunction(a.success)){Ext.callback(a.success,c,[b,a]);
}}if(Ext.isFunction(a.callback)){Ext.callback(a.callback,c,[b,a]);}},createOperation:function(c,b){var a=Ext.createByAlias("data.operation."+c,b);a.setProxy(this);this.pendingOperations[a._internalId]=a;return a;},completeOperation:function(a){delete this.pendingOperations[a._internalId];},clone:function(){return new this.self(this.getInitialConfig());
},destroy:function(){var b=this.pendingOperations,a,c;for(a in b){c=b[a];if(c&&c.isRunning()){c.abort();}}this.pendingOperations=null;this.callParent();}});