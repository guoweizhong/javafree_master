Ext.define("Ext.data.PageMap",{extend:"Ext.util.LruCache",config:{store:null,pageSize:0,rootProperty:""},clear:function(a){var b=this;b.pageMapGeneration=(b.pageMapGeneration||0)+1;b.indexMap={};b.callParent([a]);},updatePageSize:function(b,a){if(a!=null){throw"pageMap page size may not be changed";}},forEach:function(k,m){var g=this,d=Ext.Object.getKeys(g.map),a=d.length,h=g.getPageSize(),c,b,l,f,e;
for(c=0;c<a;c++){d[c]=+d[c];}Ext.Array.sort(d,Ext.Array.numericSortFn);m=m||g;for(c=0;c<a;c++){l=d[c];f=g.getPage(l);e=f.length;for(b=0;b<e;b++){if(k.call(m,f[b],(l-1)*h+b)===false){return;}}}},findBy:function(c,b){var d=this,a=null;b=b||d;d.forEach(function(f,e){if(c.call(b,f,e)){a=f;return false;}});
return a;},findIndexBy:function(c,b){var d=this,a=-1;b=b||d;d.forEach(function(f,e){if(c.call(b,f)){a=e;return false;}});return a;},find:function(g,f,h,d,c,b){if(Ext.isEmpty(f,false)){return null;}var e=Ext.String.createRegex(f,d,c,b),a=this.getRootProperty();return this.findBy(function(i){return i&&e.test((a?i[a]:i)[g]);
},null,h);},findIndex:function(g,f,h,d,c,b){if(Ext.isEmpty(f,false)){return null;}var e=Ext.String.createRegex(f,d,c,b),a=this.getRootProperty();return this.findIndexBy(function(i){return i&&e.test((a?i[a]:i)[g]);},null,h);},getPageFromRecordIndex:function(a){return Math.floor(a/this.getPageSize())+1;
},addAll:function(a){if(this.getCount()){Ext.raise("Cannot addAll to a non-empty PageMap");}this.addPage(1,a);},addPage:function(l,a){var j=this,k=j.getPageSize(),c=l+Math.floor((a.length-1)/k),h=(l-1)*k,f=j.indexMap,e,b,d,g;for(g=0;l<=c;l++,g+=k){e=Ext.Array.slice(a,g,g+k);for(b=0,d=e.length;b<d;b++){f[e[b].internalId]=h++;
}j.add(l,e);j.fireEvent("pageadd",j,l,e);}},getCount:function(){var a=this.callParent();if(a){a=(a-1)*this.getPageSize()+this.last.value.length;}return a;},getByInternalId:function(a){var b=this.indexMap[a];if(b!=null){return this.getAt(b);}},indexOf:function(b){var a=-1;if(b){a=this.indexMap[b.internalId];
if(a==null){a=-1;}}return a;},insert:function(){Ext.raise("insert operation not suppported into buffered Store");},remove:function(){Ext.raise("remove operation not suppported from buffered Store");},removeAt:function(){Ext.raise("removeAt operation not suppported from buffered Store");},removeAtKey:function(f){var e=this,c=e.getPage(f),b,d,a;
if(c){if(e.fireEvent("beforepageremove",e,f,c)!==false){b=c.length;for(d=0;d<b;d++){delete e.indexMap[c[d].internalId];}a=e.callParent(arguments);e.fireEvent("pageremove",e,f,c);c.length=0;}}return a;},getPage:function(a){return this.get(a);},hasRange:function(e,b){var c=this,a=c.getPageFromRecordIndex(e),d=c.getPageFromRecordIndex(b);
for(;a<=d;a++){if(!c.hasPage(a)){return false;}}return(d-1)*c._pageSize+c.getPage(d).length>b;},hasPage:function(a){return !!this.get(a);},peekPage:function(a){return this.map[a];},getAt:function(a){return this.getRange(a,a+1)[0];},getRange:function(a,b){if(b){b--;}if(!this.hasRange(a,b)){Ext.raise("PageMap asked for range which it does not have");
}var g=this,d=Ext.Array,h=g.getPageSize(),k=g.getPageFromRecordIndex(a),e=g.getPageFromRecordIndex(b),c=(k-1)*h,m=(e*h)-1,i=k,n=[],l,f,j;for(;i<=e;i++){if(i===k){l=a-c;j=l>0;}else{l=0;j=false;}if(i===e){f=h-(m-b);j=j||f<h;}if(j){d.push(n,d.slice(g.getPage(i),l,f));}else{d.push(n,g.getPage(i));}}return n;
}});