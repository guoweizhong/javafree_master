Ext.define("Ext.data.LocalStore",{extend:"Ext.Mixin",requires:["Ext.data.Group"],mixinConfig:{id:"localstore"},config:{extraKeys:null},applyExtraKeys:function(a){var c,b=this.getData();b.setExtraKeys(a);a=b.getExtraKeys();for(c in a){this[c]=a[c];}},add:function(a){return this.insert(this.getCount(),arguments.length===1?a:arguments);
},constructDataCollection:function(){var a=new Ext.util.Collection({rootProperty:"data",groupConfig:{xclass:"Ext.data.Group",store:this}});a.addObserver(this);return a;},createModel:function(a){var b=this.getSession(),c;if(!a.isModel){c=this.getModel();a=new c(a,b);}return a;},createFiltersCollection:function(){return this.getData().getFilters();
},createSortersCollection:function(){var a=this.getData().getSorters();a.setSorterConfigure(this.addFieldTransform,this);return a;},getSummaryRecord:function(){var c=this,b=c.summaryRecord,e=c.getData(),d=e.generation,a;if(!b){a=c.getModel().getSummaryModel();c.summaryRecord=b=new a();}if(!b.isRemote&&b.summaryGeneration!==d){b.calculateSummary(e.items);
b.summaryGeneration=d;}return b;},onCollectionBeginUpdate:function(){this.beginUpdate();},onCollectionEndUpdate:function(){this.endUpdate();},onCollectionSort:function(){this.onSorterEndUpdate();},onCollectionFilter:function(){this.onFilterEndUpdate();},notifySorterChange:function(){this.getData().onSorterChange();
},forceLocalSort:function(){var a=this.getSorters();a.beginUpdate();a.endUpdate();},contains:function(a){return this.indexOf(a)>-1;},each:function(e,d,h){var g=this.getData(),f=h,a,b,c;if(typeof h==="object"){f=h.filtered;}if(f&&g.filtered){g=g.getSource();}g=g.items.slice(0);a=g.length;for(c=0;c<a;++c){b=g[c];
if(e.call(d||b,b,c,a)===false){break;}}},collect:function(f,e,b){var c=this,a=e,d=c.getData();if(typeof e==="object"){b=e.filtered;a=e.allowNull;}if(b&&d.filtered){d=d.getSource();}return d.collect(f,"data",a);},getById:function(b){var a=this.getData();if(a.filtered){a=a.getSource();}return a.get(b)||null;
},getByInternalId:function(a){var c=this.getData(),b;if(c.filtered){if(!c.$hasExtraKeys){b=this.makeInternalKeyCfg();c.setExtraKeys(b);c.$hasExtraKeys=true;}c=c.getSource();}if(!c.$hasExtraKeys){c.setExtraKeys(b||this.makeInternalKeyCfg());c.$hasExtraKeys=true;}return c.byInternalId.get(a)||null;},getDataSource:function(){var a=this.getData();
return a.getSource()||a;},indexOf:function(a){return this.getData().indexOf(a);},indexOfId:function(a){return this.indexOf(this.getById(a));},insert:function(c,b){var e=this,a,d;if(b){if(!Ext.isIterable(b)){b=[b];}else{b=Ext.Array.clone(b);}a=b.length;}if(!a){return[];}for(d=0;d<a;++d){b[d]=e.createModel(b[d]);
}e.getData().insert(c,b);return b;},queryBy:function(b,a){var c=this.getData();return(c.getSource()||c).createFiltered(b,a);},query:function(e,d,f,a,b){var c=this.getData();return(c.getSource()||c).createFiltered(e,d,f,a,b);},first:function(a){return this.getData().first(a)||null;},last:function(a){return this.getData().last(a)||null;
},sum:function(c,a){var b=this.getData();return(a&&this.isGrouped())?b.sumByGroup(c):b.sum(c);},count:function(a){var b=this.getData();return(a&&this.isGrouped())?b.countByGroup():b.count();},min:function(c,a){var b=this.getData();return(a&&this.isGrouped())?b.minByGroup(c):b.min(c);},max:function(c,a){var b=this.getData();
return(a&&this.isGrouped())?b.maxByGroup(c):b.max(c);},average:function(c,a){var b=this.getData();return(a&&this.isGrouped())?b.averageByGroup(c):b.average(c);},aggregate:function(g,k,e,h){var f=this,a,d,b,j,c;if(e&&f.isGrouped()){a=f.getGroups().items;d=a.length;b={};for(c=0;c<d;++c){j=a[c];b[j.getGroupKey()]=f.getAggregate(g,k||f,j.items,h);
}return b;}else{return f.getAggregate(g,k,f.getData().items,h);}},getAggregate:function(f,e,c,g){var b=[],a=c.length,d;for(d=0;d<a;++d){b[d]=c[d].get(g);}return f.call(e||this,c,b);},addObserver:function(a){var b=this.observers;if(!b){this.observers=b=new Ext.util.Collection();}b.add(a);},removeObserver:function(a){var b=this.observers;
if(b){b.remove(a);}},callObservers:function(g,d){var h=this.observers,a,c,e,b,f;if(h){c=h.items;if(d){d.unshift(this);}else{d=[this];}for(e=0,a=c.length;e<a;++e){f=c[e];b="onSource"+g;if(f[b]){f[b].apply(f,d);}}}},queryRecordsBy:function(e,d){var g=this.getData(),f=[],a,c,b;g=(g.getSource()||g).items;
d=d||this;for(c=0,a=g.length;c<a;++c){b=g[c];if(e.call(d,b)===true){f.push(b);}}return f;},queryRecords:function(g,f){var e=this.getData(),d=[],a,c,b;e=(e.getSource()||e).items;for(c=0,a=e.length;c<a;++c){b=e[c];if(b.get(g)===f){d.push(b);}}return d;},privates:{isLast:function(a){return a===this.last();
},makeInternalKeyCfg:function(){return{byInternalId:{property:"internalId",rootProperty:""}};}}});