Ext.define("Ext.data.AbstractStore",{mixins:["Ext.mixin.Observable","Ext.mixin.Factoryable"],requires:["Ext.util.Collection","Ext.data.Range","Ext.data.schema.Schema","Ext.util.Filter"],factoryConfig:{defaultType:"store",type:"store"},$configPrefixed:false,$configStrict:false,config:{filters:null,autoDestroy:undefined,storeId:null,statefulFilters:false,sorters:null,remoteSort:{lazy:true,$value:false},remoteFilter:{lazy:true,$value:false},groupField:undefined,groupDir:"ASC",grouper:null,pageSize:25,autoSort:null},currentPage:1,loading:false,isStore:true,updating:0,constructor:function(b){var c=this,a;
c.callParent([b]);c.isInitializing=true;c.mixins.observable.constructor.call(c,b);c.isInitializing=false;a=c.getStoreId();if(!a&&(b&&b.id)){c.setStoreId(a=b.id);}if(a){Ext.data.StoreManager.register(c);}},createActiveRange:function(b){var a=Ext.apply({store:this},b);return new Ext.data.Range(a);},syncActiveRanges:function(){var b=this.activeRanges,a=b&&b.length,c;
for(c=0;c<a;c++){b[c].refresh();}},getCount:function(){var a=this.getData();return a?a.getCount():0;},rangeCached:function(b,a){return this.getData().getCount()>=Math.max(b,a);},find:function(f,e,g,h,a,d){var c=!h,b=!!(c&&d);return this.getData().findIndex(f,e,g,c,b,!a);},findRecord:function(){var b=this,a=b.find.apply(b,arguments);
return a!==-1?b.getAt(a):null;},findExact:function(c,a,b){return this.getData().findIndexBy(function(d){return d.isEqual(d.get(c),a);},this,b);},findBy:function(b,a,c){return this.getData().findIndexBy(b,a,c);},getAt:function(a){return this.getData().getAt(a)||null;},getRange:function(d,b,c){var a=this.getData().getRange(d,Ext.isNumber(b)?b+1:b);
if(c&&c.callback){c.callback.call(c.scope||this,a,d,b,c);}return a;},getFilters:function(b){var a=this.callParent();if(!a&&b!==false){this.setFilters([]);a=this.callParent();}return a;},applyFilters:function(b,a){var c;if(!a){a=this.createFiltersCollection();c=true;}a.add(b);if(c){this.onRemoteFilterSet(a,this.getRemoteFilter());
}return a;},getSorters:function(b){var a=this.callParent();if(!a&&b!==false){this.setSorters([]);a=this.callParent();}return a;},applySorters:function(b,a){var c;if(!a){a=this.createSortersCollection();c=true;}a.add(b);if(c){this.onRemoteSortSet(a,this.getRemoteSort());}return a;},filter:function(b,c,a){if(Ext.isString(b)){b={property:b,value:c};
}this.suppressNextFilter=!!a;this.getFilters().add(b);this.suppressNextFilter=false;},removeFilter:function(b,a){var d=this,c=d.getFilters();d.suppressNextFilter=!!a;if(b instanceof Ext.util.Filter){c.remove(b);}else{c.removeByKey(b);}d.suppressNextFilter=false;},updateAutoSort:function(a){this.getData().setAutoSort(a);
},updateRemoteSort:function(a){this.onRemoteSortSet(this.getSorters(false),a);},updateRemoteFilter:function(a){this.onRemoteFilterSet(this.getFilters(false),a);},addFilter:function(b,a){this.suppressNextFilter=!!a;this.getFilters().add(b);this.suppressNextFilter=false;},filterBy:function(b,a){this.getFilters().add({filterFn:b,scope:a||this});
},clearFilter:function(a){var c=this,b=c.getFilters(false);if(!b||b.getCount()===0){return;}c.suppressNextFilter=!!a;b.removeAll();c.suppressNextFilter=false;},isFiltered:function(){return this.getFilters().getCount()>0;},isSorted:function(){var a=this.getSorters(false);return !!(a&&a.length>0)||this.isGrouped();
},addFieldTransform:function(e){if(e.getTransform()){return;}var d=e.getProperty(),c=this.getModel(),a,b;if(c){a=c.getField(d);b=a?a.getSortType():null;}if(b&&b!==Ext.identityFn){e.setTransform(b);}},beginUpdate:function(){if(!this.updating++&&this.hasListeners.beginupdate){this.fireEvent("beginupdate");
}},endUpdate:function(){if(this.updating&&!--this.updating){if(this.hasListeners.endupdate){this.fireEvent("endupdate");}this.onEndUpdate();}},getState:function(){var e=this,f=[],d=e.getFilters(),b=e.getGrouper(),g,c,a;e.getSorters().each(function(h){f[f.length]=h.getState();c=true;});if(e.statefulFilters&&e.saveStatefulFilters){c=true;
g=[];d.each(function(h){g[g.length]=h.getState();});}if(b){c=true;}if(c){a={};if(f.length){a.sorters=f;}if(g){a.filters=g;}if(b){a.grouper=b.getState();}}return a;},applyState:function(e){var c=this,b=e.sorters,a=e.filters,d=e.grouper;if(b){c.getSorters().replaceAll(b);}if(a){c.saveStatefulFilters=true;
c.getFilters().replaceAll(a);}if(d){c.setGrouper(d);}},hasPendingLoad:Ext.emptyFn,isLoaded:Ext.emptyFn,isLoading:Ext.emptyFn,destroy:function(){var a=this;if(a.hasListeners.beforedestroy){a.fireEvent("beforedestroy",a);}a.destroying=true;if(a.getStoreId()){Ext.data.StoreManager.unregister(a);}a.doDestroy();
if(a.hasListeners.destroy){a.fireEvent("destroy",a);}a.destroying=false;a.callParent();},doDestroy:Ext.emptyFn,sort:function(c,b,d){var a=this;if(arguments.length===0){if(a.getRemoteSort()){a.load();}else{a.forceLocalSort();}}else{a.getSorters().addSort(c,b,d);}},onBeforeCollectionSort:function(a,b){if(b){this.fireEvent("beforesort",this,b.getRange());
}},onSorterEndUpdate:function(){var a=this,b;b=a.getSorters(false);if(a.settingGroups||!b){return;}b=b.getRange();if(b.length){if(a.getRemoteSort()){a.load({callback:function(){a.fireEvent("sort",a,b);}});}else{a.fireEvent("datachanged",a);a.fireEvent("refresh",a);a.fireEvent("sort",a,b);}}else{a.fireEvent("sort",a,b);
}},onFilterEndUpdate:function(){var c=this,b=c.suppressNextFilter,a=c.getFilters(false);if(!a){return;}if(c.getRemoteFilter()){c.getFilters().each(function(d){if(d.getInitialConfig().filterFn){Ext.raise("Unable to use a filtering function in conjunction with remote filtering.");}});c.currentPage=1;if(!b){c.load();
}}else{if(!b){c.fireEvent("datachanged",c);c.fireEvent("refresh",c);}}if(c.trackStateChanges){c.saveStatefulFilters=true;}c.fireEvent("filterchange",c,c.getFilters().getRange());},updateGroupField:function(a){if(a){this.setGrouper({property:a,direction:this.getGroupDir()});}else{this.setGrouper(null);
}},getGrouper:function(){return this.getData().getGrouper();},group:function(a,e){var b=this,d=b.getSorters(false),f=a||(d&&d.length),c=b.getData();if(a&&typeof a==="string"){a={property:a,direction:e||b.getGroupDir()};}b.settingGroups=true;if(a===c.getGrouper()){c.updateGrouper(a);}else{c.setGrouper(a);
}delete b.settingGroups;if(f){if(b.getRemoteSort()){if(!b.isInitializing){b.load({scope:b,callback:b.fireGroupChange});}}else{b.fireEvent("datachanged",b);b.fireEvent("refresh",b);b.fireGroupChange();}}else{b.fireGroupChange();}},fireGroupChange:function(){if(!this.destroyed){this.fireEvent("groupchange",this,this.getGrouper());
}},clearGrouping:function(){this.group(null);},getGroupField:function(){var a=this.getGrouper(),b="";if(a){b=a.getProperty();}return b;},isGrouped:function(){return !!this.getGrouper();},applyGrouper:function(a){this.group(a);return this.getData().getGrouper();},getGroups:function(){return this.getData().getGroups();
},onEndUpdate:Ext.emptyFn,privates:{_metaProperties:{count:"getCount",first:"first",last:"last",loading:"hasPendingLoad",totalCount:"getTotalCount"},interpret:function(b){var c=this,a=c._metaProperties[b];return a&&c[a]();},loadsSynchronously:Ext.privateFn,onRemoteFilterSet:function(a,b){if(a){a[b?"on":"un"]("endupdate","onFilterEndUpdate",this);
}},onRemoteSortSet:function(c,d){var a=this,b;if(c){c[d?"on":"un"]("endupdate","onSorterEndUpdate",a);b=a.getData();if(b){b[d?"un":"on"]("beforesort","onBeforeCollectionSort",a);}}}},deprecated:{5:{methods:{destroyStore:function(){this.destroy();}}}}});