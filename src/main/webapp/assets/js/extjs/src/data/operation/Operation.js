Ext.define("Ext.data.operation.Operation",{alternateClassName:"Ext.data.Operation",isOperation:true,config:{synchronous:false,url:"",params:undefined,callback:undefined,scope:undefined,resultSet:null,response:null,request:null,records:null,id:undefined,proxy:null,batch:null,recordCreator:null,internalCallback:null,internalScope:null},order:0,foreignKeyDirection:1,started:false,running:false,complete:false,success:undefined,exception:false,error:undefined,idPrefix:"ext-operation-",constructor:function(a){var b=a&&a.scope;
this.initConfig(a);if(a){a.scope=b;}if(b){this.setScope(b);this.initialConfig.scope=b;}this._internalId=Ext.id(this,this.idPrefix);},getAction:function(){return this.action;},execute:function(){var b=this,a;delete b.error;delete b.success;b.complete=b.exception=false;b.setStarted();b.request=a=b.doExecute();
if(a){a.setOperation(b);}return a;},doExecute:Ext.emptyFn,abort:function(){var b=this,a=b.request;if(b.running&&a){b.getProxy().abort(a);b.request=null;}},process:function(b,d,a,e){var c=this;e=e!==false;c.setResponse(a);c.setResultSet(b);if(b.getSuccess()){c.doProcess(b,d,a);c.setSuccessful(e);}else{if(e){c.setException(b.getMessage());
}}},_commitSetOptions:{convert:true,commit:true},doProcess:function(m,f,e){var k=this,d=k._commitSetOptions,a=k.getRecords(),c=a.length,n=a[0].clientIdProperty,o=m.getRecords(),j=o?o.length:0,l,h,b,g;if(j&&n){l=Ext.Array.toValueMap(a,"id");for(g=0;g<j;++g){h=o[g];b=l[h[n]];if(b){delete l[b.id];delete h[n];
b.set(h,d);}else{Ext.log.warn("Ignoring server record: "+Ext.encode(h));}}for(g in l){l[g].commit();}}else{for(g=0;g<c;++g){b=a[g];if(j===0||!(h=o[g])){b.commit();}else{b.set(h,d);}}}},setStarted:function(){this.started=this.running=true;},setCompleted:function(){var b=this,a=b.getProxy();b.complete=true;
b.running=false;b.triggerCallbacks();if(a&&!a.destroyed){a.completeOperation(b);}},setSuccessful:function(a){this.success=true;if(a){this.setCompleted();}},setException:function(a){var b=this;b.exception=true;b.success=b.running=false;b.error=a;b.setCompleted();},triggerCallbacks:function(){var a=this,b=a.getInternalCallback();
if(b){b.call(a.getInternalScope()||a,a);a.setInternalCallback(null);a.setInternalScope(null);}if(b=a.getCallback()){b.call(a.getScope()||a,a.getRecords(),a,a.wasSuccessful());a.setCallback(null);a.setScope(null);}},hasException:function(){return this.exception;},getError:function(){return this.error;
},getRecords:function(){var a;return this._records||((a=this.getResultSet())?a.getRecords():null);},isStarted:function(){return this.started;},isRunning:function(){return this.running;},isComplete:function(){return this.complete;},wasSuccessful:function(){return this.isComplete()&&this.success===true;
},allowWrite:function(){return true;}});