Ext.define("Ext.data.writer.Xml",{extend:"Ext.data.writer.Writer",alternateClassName:"Ext.data.XmlWriter",alias:"writer.xml",config:{documentRoot:"xmlData",defaultDocumentRoot:"xmlData",header:"",record:"record"},selectorRe:/[^>\s]+/g,writeRecords:function(b,c){var h=this,f=[],d=0,g=c.length,k=h.getDocumentRoot(),j=h.getRecord(),e=j.match(this.selectorRe),l=e.length,m=c.length!==1&&l===1,a;
a=this.getTransform();if(a){c=a(c,b);}f.push(h.getHeader()||"");if(!k&&m){k=h.getDefaultDocumentRoot();}if(k){f.push("<",k,">");}for(d=0;d<l-1;d++){f.push("<",e[d],">");}j=e[d];for(d=0;d<g;++d){this.objectToElement(j,c[d],f);}for(d=l-2;d>-1;d--){f.push("</",e[d],">");}if(k){f.push("</",k,">");}b.setXmlData(f.join(""));
return b;},objectToElement:function(b,e,f){var n,l,g=[],d,c,j,h,k,a,m;if(!f){f=[];}f.push("<",b);for(n in e){l=e[n];if(n[0]==="@"){f.push(" ",n.substr(1),'="',l,'"');}else{if(typeof l==="object"){this.objectToElement(n,l,g);}else{d=n.match(this.selectorRe);if((c=d.length)>1){k=k||{};for(h=k,j=0;j<c;j++){a=h;
m=d[j];h=h[m]||(h[m]={});}a[m]=l;}else{g.push("<",n,">",l,"</",n,">");}}}}f.push(">");f.push.apply(f,g);if(k){for(n in k){l=k[n];this.objectToElement(n,l,f);}}f.push("</",b,">");return f;}});