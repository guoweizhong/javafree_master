Ext.define("Ext.data.Model",{alternateClassName:"Ext.data.Record",requires:["Ext.data.ErrorCollection","Ext.data.operation.*","Ext.data.field.*","Ext.data.validator.Validator","Ext.data.schema.Schema","Ext.data.identifier.Generator","Ext.data.identifier.Sequential"],uses:["Ext.data.Validation"],isEntity:true,isModel:true,validIdRe:null,erasing:false,loadOperation:null,loadCount:0,observableType:"record",crudState:"R",crudStateWas:null,constructor:function(f,m){var n=this,q=n.self,l=q.identifier,c=Ext.data.Model,o=c.identifier,p=n.idField.name,k,a,b,j,h,e,g;
n.data=n.data=f||(f={});n.session=m||null;n.internalId=j=o.generate();var d=f[p];if(m&&!m.isSession){Ext.raise('Bad Model constructor argument 2 - "session" is not a Session');}if((k=f) instanceof Array){n.data=f={};g=n.getFields();h=Math.min(g.length,k.length);for(e=0;e<h;++e){f[g[e].name]=k[e];}}if(!(b=q.initializeFn)){q.initializeFn=b=c.makeInitializeFn(q);
}if(!b.$nullFn){q.initializeFn(n);}if(!n.isSummaryModel){if(!(n.id=a=f[p])&&a!==0){if(d){Ext.raise('The model ID configured in data ("'+d+'") has been rejected by the '+n.fieldsMap[p].type+" field converter for the "+p+" field");}if(m){l=m.getIdentifier(q);a=l.generate();}else{if(o===l){a=j;}else{a=l.generate();
}}f[p]=n.id=a;n.phantom=true;n.crudState="C";}if(m){m.add(n);}}if(n.init&&Ext.isFunction(n.init)){n.init();}},editing:false,dirty:false,session:null,dropped:false,erased:false,clientIdProperty:null,evented:false,phantom:false,idProperty:"id",manyToMany:null,identifier:null,previousValues:undefined,proxy:undefined,schema:"default",summary:null,versionProperty:null,generation:1,validationSeparator:null,convertOnSet:true,beginEdit:function(){var c=this,b=c.modified,a=c.previousValues;
if(!c.editing){c.editing=true;c.editMemento={dirty:c.dirty,data:Ext.apply({},c.data),generation:c.generation,modified:b&&Ext.apply({},b),previousValues:a&&Ext.apply({},a)};}},calculateSummary:function(c){var e=this.getFields(),f=e.length,j=c.length,d,k,g,b,a,h;for(d=0;d<f;++d){h=e[d];g=h.getSummary();
if(g){k=k||{};a=h.name;b=h.summaryField||a;k[a]=g.calculate(c,b,"data",0,j);}}if(k){this.set(k,this._commitOptions);}},cancelEdit:function(){var c=this,a=c.editMemento,b=c.validation;if(a){c.editing=false;Ext.apply(c,a);c.editMemento=null;if(b&&b.syncGeneration!==c.generation){b.syncGeneration=0;}}},endEdit:function(b,d){var c=this,a=c.editMemento;
if(a){c.editing=false;c.editMemento=null;c.previousValues=a.previousValues;if(!b){if(!d){d=c.getModifiedFieldNames(a.data);}if(c.dirty||(d&&d.length)){c.callJoined("afterEdit",[d]);}}}},getField:function(a){return this.self.getField(a);},getFields:function(){return this.self.getFields();},getFieldsMap:function(){return this.fieldsMap;
},getIdProperty:function(){return this.idProperty;},getId:function(){return this.id;},getObservableId:function(){return this.internalId;},setId:function(b,a){this.set(this.idProperty,b,a);},getPrevious:function(b){var a=this.previousValues;return a&&a[b];},isModified:function(b){var a=this.modified;return !!(a&&a.hasOwnProperty(b));
},getModified:function(b){var a;if(this.isModified(b)){a=this.modified[b];}return a;},get:function(a){return this.data[a];},_singleProp:{},_rejectOptions:{convert:false,silent:true},set:function(t,G,v){var m=this,c=m.self,K=m.data,p=m.modified,x=m.previousValues,z=m.session,y=Ext.isString(t),q=(y?v:G),B=q?q.convert!==false:m.convertOnSet,C=m.fieldsMap,e=q&&q.silent,l=q&&q.commit,D=!(q&&q.refs===false)&&z,r=!(q&&q.dirty===false&&!l),o=null,h=0,d=m.associations,g,f,b,n,k,w,u,j,I,J,F,A,H,a,E,L,s;
if(y){L=m._singleProp;L[t]=G;}else{L=t;}if(!(H=c.rankedFields)){H=c.rankFields();}F=H.length;do{for(k in L){E=L[k];g=K[k];u=m;f=C[k];if(f){if(B&&f.convert){E=f.convert(E,m);}u=f;a=f.reference;}else{a=null;}if(u.isEqual(g,E)){continue;}K[k]=E;(o||(o=[])).push(k);(x||(m.previousValues=x={}))[k]=g;if(a&&a.cls){if(D){z.updateReference(m,f,E,g);
}a.onValueChange(m,z,E,g);}J=(I=f&&f.dependents)&&I.length;while(J-->0){(j=I[J]).dirty=true;h=h?Math.min(h,j.rank):j.rank;}if(!f||f.persist){if(p&&p.hasOwnProperty(k)){if(!r||u.isEqual(p[k],E)){delete p[k];m.dirty=-1;}}else{if(r){if(!p){m.modified=p={};}m.dirty=true;p[k]=g;}}}if(k===m.idField.name){b=true;
w=g;A=E;}}if(!h){break;}f=H[h-1];f.dirty=false;if(y){delete L[t];}else{L=m._singleProp;y=true;}t=f.name;L[t]=K[t];B=true;for(;h<F;++h){if(H[h].dirty){break;}}if(h<F){++h;}else{h=0;}}while(1);if(m.dirty<0){m.dirty=false;for(n in p){if(p.hasOwnProperty(n)){m.dirty=true;break;}}}if(y){delete L[t];}++m.generation;
if(b){m.id=A;m.onIdChanged(A,w);m.callJoined("onIdChanged",[w,A]);if(d){for(s in d){d[s].onIdChanged(m,w,A);}}}if(l){m.commit(e,o);}else{if(!e&&!m.editing&&o){m.callJoined("afterEdit",[o]);}}return o;},reject:function(a){var c=this,b=c.modified;if(c.erased){Ext.raise("Cannot reject once a record has been erased.");
}if(b){c.set(b,c._rejectOptions);}c.dropped=false;c.clearState();if(!a){c.callJoined("afterReject");}},commit:function(b,d){var c=this,f=c.versionProperty,e=c.data,a;c.clearState();if(f&&!c.phantom&&!isNaN(e[f])){++e[f];}c.phantom=false;if(c.dropped){c.erased=a=true;}if(!b){if(a){c.callJoined("afterErase");
}else{c.callJoined("afterCommit",[d]);}}},clearState:function(){var a=this;a.dirty=a.editing=false;a.editMemento=a.modified=null;},drop:function(b){var d=this,c=d.associations,e=d.session,a;if(d.erased||d.dropped){return;}d.dropped=true;if(c&&b!==false){for(a in c){c[a].onDrop(d,e);}}d.callJoined("afterDrop");
if(d.phantom){d.setErased();}},join:function(a){var b=this,c=b.joined;if(!c){c=b.joined=[a];}else{if(!c.length){c[0]=a;}else{Ext.Array.include(c,a);}}if(a.isStore&&!b.store){b.store=a;}},unjoin:function(b){var e=this,f=e.joined,a=f&&f.length,c=e.store,d;if(b===e.session){e.session=null;}else{if(a===1&&f[0]===b){f.length=0;
}else{if(a){Ext.Array.remove(f,b);}}if(c===b){c=null;if(f){for(d=0,a=f.length;d<a;++d){b=f[d];if(b.isStore){c=b;break;}}}e.store=c;}}},clone:function(d){var c=this,b=c.modified,a=c.copy(c.id,d);if(b){a.modified=Ext.apply({},b);}a.dirty=c.dirty;a.dropped=c.dropped;a.phantom=c.phantom;return a;},copy:function(c,f){var d=this,e=Ext.apply({},d.data),b=d.idProperty,a=d.self;
if(c||c===0){e[b]=c;}else{if(c===null){delete e[b];}}return new a(e,f);},getProxy:function(){return this.self.getProxy();},getValidation:function(b){var c=this,a=c.validation;if(!a){c.validation=a=new Ext.data.Validation();a.attach(c);}if(b===true||(b!==false&&a.syncGeneration!==c.generation)){a.refresh(b);
}return a;},validate:function(){return new Ext.data.ErrorCollection().init(this);},isValid:function(){return this.getValidation().isValid();},toUrl:function(){var b=this.$className.split("."),a=b[b.length-1].toLowerCase();return a+"/"+this.getId();},erase:function(a){var b=this;b.erasing=true;b.drop();
b.erasing=false;return b.save(a);},setErased:function(){this.erased=true;this.callJoined("afterErase");},getChanges:function(){return this.getData(this._getChangesOptions);},getCriticalFields:function(){var a=this.self,b=a.criticalFields;if(!b){a.rankFields();b=a.criticalFields;}return b;},getAssociatedData:function(q,p){var l=this,c=l.associations,n,g,o,k,d,b,j,f,e,a,h,m;
q=q||{};l.$gathering=1;if(p){p=Ext.apply({},p);}for(e in c){f=c[e];o=f.getAssociatedItem(l);if(!o||o.$gathering){continue;}if(o.isStore){o.$gathering=1;k=o.getData().items;b=k.length;d=[];for(g=0;g<b;++g){j=k[g];n=!j.$gathering;j.$gathering=1;if(p){m=p.associated;if(m===undefined){p.associated=n;h=true;
}else{if(!n){p.associated=false;h=true;}}a=p;}else{a=n?l._getAssociatedOptions:l._getNotAssociatedOptions;}d.push(j.getData(a));if(h){p.associated=m;h=false;}delete j.$gathering;}delete o.$gathering;}else{a=p||l._getAssociatedOptions;if(p&&p.associated===undefined){a.associated=true;}d=o.getData(a);}q[e]=d;
}delete l.$gathering;return q;},getData:function(r){var j=this,i={},a=(r===true)?j._getAssociatedOptions:(r||i),e=j.data,k=a.associated,o=a.changes,m=o&&a.critical,h=o?j.modified:e,g=j.fieldsMap,f=a.persist,q=a.serialize,c,l,d,b,p;if(h){for(b in h){p=e[b];l=g[b];if(l){if(f&&!l.persist){continue;}if(q&&l.serialize){p=l.serialize(p,j);
}}i[b]=p;}}if(m){c=j.self.criticalFields||j.getCriticalFields();for(d=c.length;d-->0;){b=(l=c[d]).name;if(!(b in i)){p=e[b];if(q&&l.serialize){p=l.serialize(p,j);}i[b]=p;}}}if(k){if(typeof k==="object"){j.getNestedData(a,i);}else{j.getAssociatedData(i,a);}}return i;},getNestedData:function(n,o){var k=this,c=k.associations,l=n.associated,g,m,j,d,b,h,f,e,a;
o=o||{};for(e in l){f=c[e];a=l[e];if(a===true){delete n.associated;}else{n.associated=a;}m=f.getAssociatedItem(k);if(m.isStore){j=m.getData().items;b=j.length;d=[];for(g=0;g<b;++g){h=j[g];d.push(h.getData(n));}}else{d=m.getData(n);}o[e]=d;}n.associated=l;return o;},getTransientFields:function(){var a=this.self,b=a.transientFields;
if(!b){a.rankFields();b=a.transientFields;}return b;},isLoading:function(){return !!this.loadOperation;},abort:function(){var a=this.loadOperation;if(a){a.abort();}},load:function(i){i=Ext.apply({},i);var f=this,h=i.scope||f,e=f.getProxy(),g=i.callback,c=f.loadOperation,a=f.getId(),b;if(c){b=c.extraCalls;
if(!b){b=c.extraCalls=[];}b.push(i);return c;}var d=true;if(f.phantom){d=false;}i.id=a;i.recordCreator=function(l,j,k){var m=f.session;if(k){k.recordCreator=m?m.recordCreator:null;}f.set(l,f._commitOptions);if(d&&f.getId()!==a){Ext.raise("Invalid record id returned for "+a+"@"+f.entityName);}return f;
};i.internalCallback=function(l){var p=l.wasSuccessful()&&l.getRecords().length>0,q=f.loadOperation,n=q.extraCalls,k=[f,l],o=[f,l,p],m,j;f.loadOperation=null;++f.loadCount;if(p){Ext.callback(i.success,h,k);}else{Ext.callback(i.failure,h,k);}Ext.callback(g,h,o);if(n){for(m=0,j=n.length;m<j;++m){i=n[m];
if(p){Ext.callback(i.success,h,k);}else{Ext.callback(i.failure,h,k);}Ext.callback(i.callback,h,o);}}f.callJoined("afterLoad");};delete i.callback;f.loadOperation=c=e.createOperation("read",i);c.execute();return c;},mergeData:function(a){if(!this.dirty){this.set(a,this._commitOptions);}},save:function(i){i=Ext.apply({},i);
var f=this,d=f.phantom,a=f.dropped,c=a?"destroy":(d?"create":"update"),h=i.scope||f,g=i.callback,e=f.getProxy(),b;i.records=[f];i.internalCallback=function(j){var k=[f,j],l=j.wasSuccessful();if(l){Ext.callback(i.success,h,k);}else{Ext.callback(i.failure,h,k);}k.push(l);Ext.callback(g,h,k);};delete i.callback;
b=e.createOperation(c,i);if(a&&d){b.setResultSet(Ext.data.reader.Reader.prototype.nullResultSet);f.setErased();b.setSuccessful(true);}else{b.execute();}return b;},statics:{defaultProxy:"memory"},inheritableStatics:{_associatedReadOptions:{recordsOnly:true,asRoot:true},loadData:function(a,b){var c;if(a){c=this.getProxy().getReader().readRecords([a],b?{recordCreator:b.recordCreator}:undefined,this._associatedReadOptions)[0];
}else{c=new this(a,b);}return c;},getSummaryModel:function(){var b=this,a=b.prototype,c=b.summaryModel;if(!c){c=Ext.define(null,{extend:b,fields:a.summaryFields||[],isSummaryModel:true});c.isSummaryModel=true;b.summaryModel=a.summaryModel=c;}return c||null;},addFields:function(a){this.replaceFields(a);
},replaceFields:function(n,k){var o=this,f=o.prototype,j=Ext.data.field.Field,g=o.fields,m=o.fieldsMap,d=o.fieldOrdinals,p,e,c,h,b,l,a;if(k===true){g.length=0;o.fieldsMap=m={};o.fieldOrdinals=d={};a=true;}else{if(k){for(e=k.length;e-->0;){b=k[e];if(b in d){delete d[b];delete m[b];}}for(e=0,h=g.length;
e<h;++e){b=(p=g[e]).name;if(b in d){d[b]=e;}else{g.splice(e,1);--e;--h;}}}}for(e=0,h=n?n.length:0;e<h;e++){b=(p=n[e]).name;if(!(b in d)){d[b]=l=g.length;g.push(p=j.create(p));m[b]=p;p.ordinal=l;p.definedBy=p.owner=this;}}if(!a){for(e=0,h=g.length;e<h;++e){g[e].rank=null;}}o.idField=f.idField=c=m[f.idProperty];
c.allowNull=c.critical=c.identifier=true;c.defaultValue=null;o.initializeFn=o.rankedFields=o.transientFields=o.criticalFields=null;},removeFields:function(a){this.replaceFields(null,a);},getIdFromData:function(c){var b=this,a=b.idField,d=a.calculated?(new b(c)).id:c[a.name];return d;},createWithId:function(f,b,c){var e=b,a=this;
if(f||f===0){e={};if(b){Ext.apply(e,b);}e[a.idField.name]=f;}return new a(e,c);},getFields:function(){return this.fields;},getFieldsMap:function(){return this.fieldsMap;},getField:function(a){return this.fieldsMap[a]||null;},getProxy:function(){var b=this,a=b.proxy,d=b.defaultProxy,c;if(!a){a=b.proxyConfig;
if(!a&&d){a=d;}if(!a||!a.isProxy){if(typeof a==="string"){a={type:a};}c=b.schema.constructProxy(b);a=a?Ext.merge(c,a):c;}a=b.setProxy(a);}return a;},setProxy:function(b){var c=this,a;if(b){if(!b.isProxy){b=Ext.Factory.proxy(b);}else{a=b.getModel();if(a&&a!==c){b=b.clone();}}b.setModel(c);}return(c.prototype.proxy=c.proxy=b);
},load:function(e,a,c){var b={},d;if(c){d=c.peekRecord(this,e);}if(!d){b[this.prototype.idProperty]=e;d=new this(b,c);}d.load(a);return d;}},deprecated:{5:{methods:{hasId:null,markDirty:null,setDirty:null,eachStore:function(f,d){var e=this,b=e.stores,a=b.length,c;for(c=0;c<a;++c){f.call(d,b[c]);}},join:function(c){var b=this,a=b.stores,d=b.joined;
if(!d){d=b.joined=[c];}else{d.push(c);}if(c.isStore){b.store=b.store||c;if(!a){a=b.stores=[];}a.push(c);}},unjoin:function(c){var b=this,a=b.stores,d=b.joined;if(d.length===1){d.length=0;}else{Ext.Array.remove(d,c);}if(c.isStore){Ext.Array.remove(a,c);b.store=a[0]||null;}}},properties:{persistenceProperty:null},inheritableStatics:{methods:{setFields:null}}}},privates:{_commitOptions:{commit:true},_getChangesOptions:{changes:true},_getAssociatedOptions:{associated:true},_getNotAssociatedOptions:{associated:false},_metaProperties:{dirty:"isDirty",phantom:"isPhantom",valid:"isValid"},copyFrom:function(h){var g=this,e=g.fields,l=e.length,b=[],j,c=0,f,d,m=g.idProperty,a,k;
if(h){f=g.data;d=h.data;for(;c<l;c++){j=e[c];a=j.name;if(a!==m){k=d[a];if(k!==undefined&&!g.isEqual(f[a],k)){f[a]=k;b.push(a);}}}if(g.phantom&&!h.phantom){g.beginEdit();g.setId(h.getId());g.endEdit(true);g.commit(true);}}return b;},callJoined:function(e,d){var g=this,j=g.joined,f=g.session,a=g.dropped?"D":(g.phantom?"C":(g.dirty?"U":"R")),b,c,h,k;
g.crudState=a;if(j||f){if(d){d.unshift(g);}else{d=[g];}if(j){for(b=0,c=j.length;b<c;++b){k=j[b];if(k&&(h=k[e])){h.apply(k,d);}}}h=f&&f[e];if(h){h.apply(f,d);}}g.crudStateWas=a;},hasPendingLoad:function(){return this.isLoading();},interpret:function(b){var c=this,a=c._metaProperties[b];if(!a){a=c.associations;
a=a&&a[b]&&a[b].getterName;}if(a){return c[a]();}return c.data[b];},isDirty:function(){return this.dirty;},isPhantom:function(){return this.phantom;},onAssociatedRecordSet:function(a,b){this.callJoined("afterAssociatedRecordSet",[a,b]);},onIdChanged:Ext.privateFn,setSession:function(a){if(a){if(this.session){Ext.raise("This model already belongs to a session.");
}if(!this.id){Ext.raise("The model must have an id to participate in a session.");}}this.session=a;if(a){a.add(this);}},getModifiedFieldNames:function(a){var d=this,e=d.data,b=[],f=a||d.editMemento.data,c;for(c in e){if(e.hasOwnProperty(c)){if(!d.isEqual(e[c],f[c],c)){b.push(c);}}}return b;},isEqual:function(a,d,c){var b;
if(c){b=c.isField?c:this.fieldsMap[c];if(b){return b.isEqual(a,d);}}if(a instanceof Date&&d instanceof Date){return a.getTime()===d.getTime();}return a===d;},statics:{EDIT:"edit",REJECT:"reject",COMMIT:"commit",rankFields:function(){var j=this,h=j.prototype,d=j.fields,b=d.length,f=[],a=[],e=[],k,g,c;
j.rankedFields=h.rankedFields=f;j.criticalFields=h.criticalFields=a;j.transientFields=h.transientFields=e;for(c=0;c<b;++c){g=d[c];if(g.critical){a.push(g);}if(!g.persist){e.push(g);}if(g.evil){(k||(k=[])).push(g);}else{if(!g.depends){f.push(g);g.rank=f.length;}}}for(c=0;c<b;++c){if(!(g=d[c]).rank&&!g.evil){j.topoAdd(g);
}}if(k){for(c=0,b=k.length;c<b;++c){f.push(g=k[c]);g.rank=f.length;}}j.topoStack=null;return f;},topoAdd:function(h){var b=this,g=h.depends,a=g?g.length:0,e=b.rankedFields,c,f;var d=b.topoStack||(b.topoStack=[]);d.push(h.name);if(h.rank===0){Ext.raise(b.$className+" has circular field dependencies: "+d.join(" --> "));
}if(d.length&&h.evil){Ext.raise(b.$className+": Field "+d[d.length-1]+" cannot depend on depends-less field "+h.name);}h.rank=0;for(c=0;c<a;++c){f=b.fieldsMap[g[c]];if(!f){Ext.raise(b.$className+": Field "+h.name+" depends on undefined field "+g[c]);}(f.dependents||(f.dependents=[])).push(h);if(!f.rank){b.topoAdd(f);
}}e.push(h);h.rank=e.length;d.pop();},initFields:function(v,b,o){var j=Ext.data.field.Field,d=v.fields,p=[],k={},f={},a=[],u=o.fields,l=v.versionProperty||o.versionProperty,m=b.idProperty,g,c,s,e,w,r,h,t,q,n;b.fields=o.fields=p;b.fieldOrdinals=o.fieldOrdinals=k;b.fieldsMap=o.fieldsMap=f;b.references=o.references=a;
if(u){for(s=0,e=u.length;s<e;++s){p[s]=c=Ext.Object.chain(u[s]);c.dependents=null;c.owner=b;k[w=c.name]=s;f[w]=c;c.rank=null;if(c.generated){t=c;q=c.name;}}}delete v.fields;if(d){for(s=0,e=d.length;s<e;++s){c=d[s];h=c.reference;if(h&&typeof h!=="string"){h=Ext.merge({},h);}c.$reference=h;c=j.create(d[s]);
w=c.name;r=k[w];if(r===undefined){k[w]=r=p.length;}f[w]=c;p[r]=c;c.definedBy=c.owner=b;c.ordinal=r;if(w===m){n=c;}}}g=f[m];if(!g){if(t&&t.generated){r=t.ordinal;}else{r=p.length;}delete f[q];delete k[q];g=new j(m);p[r]=g;k[m]=r;f[m]=g;g.definedBy=b;g.ordinal=r;g.generated=true;}else{if(n&&t&&t.generated){Ext.Array.remove(p,t);
delete f[q];delete k[q];f[m]=n;for(s=0,e=p.length;s<e;++s){c=p[s];p.ordinal=s;k[c.name]=s;}}}g.allowNull=g.critical=g.identifier=true;g.defaultValue=null;b.idField=o.idField=g;if(l){c=f[l];if(!c){r=p.length;c=new j({name:l,type:"int"});p[r]=c;k[l]=r;f[l]=c;c.definedBy=b;c.ordinal=r;c.generated=true;}c.defaultValue=1;
c.critical=true;}},initSummaries:function(e,n,f){var c=e.summary,b=f.summaryFields,m,k,a,j,h,d,g,l;if(b){m=[];k={};for(d=0,h=b.length;d<h;++d){j=b[d];m.push(j);m[j.name]=d;}}if(c){delete e.summary;m=m||[];k=k||{};for(a in c){j=c[a];if(typeof j==="function"){j={summary:j};}g=k[a];j=Ext.apply({name:a},j);
l=j.field;if(l){delete j.field;j.summaryField=l;}if(g===undefined){g=m.length;k[a]=j;}m[g]=j;}}if(m){for(d=0,h=m.length;d<h;++d){if(m[d].name in f.fieldsMap){Ext.raise("Cannot redefine field, use the summary property on the field.");}}f.summaryFields=m;}},initValidators:function(g,o,j){var m=j.validators,e,l,c,k,f,d,h,b,a,n;
if(m){e={};for(l in m){e[l]=Ext.Array.clone(m[l]);}}k=g.validators||g.validations;if(g.validations){delete g.validations;Ext.log.warn((o.$className||"Ext.data.Model")+": validations has been deprecated. Please use validators instead.");}if(k){delete g.validators;e=e||{};if(Ext.isArray(k)){c={};for(f=0,d=k.length;
f<d;++f){n=k[f];b=n.field;if(!c[b]){c[b]=[];}n=n.fn||n;c[b].push(n);}k=c;}for(b in k){h=k[b];if(!Ext.isArray(h)){h=[h];}a=e[b];if(a){Ext.Array.push(a,h);}else{e[b]=h;}}}if(e){for(b in e){l=o.getField(b);if(l){l.setModelValidators(e[b]);}}}o.validators=j.validators=e;},initAssociations:function(d,g,l){var c=g.associations,e=g.belongsTo,j=g.hasMany,m=g.hasOne,k=g.manyToMany,f,b,h,a;
delete g.associations;delete g.belongsTo;delete g.hasMany;delete g.hasOne;delete g.manyToMany;if(k){d.addMatrices(l,k);}if(c){c=Ext.isArray(c)?c:[c];for(f=0,b=c.length;f<b;++f){h=c[f];a=Ext.apply({},h);delete a.type;switch(h.type){case"belongsTo":d.addBelongsTo(l,a);break;case"hasMany":d.addHasMany(l,a);
break;case"hasOne":d.addHasOne(l,a);break;default:Ext.raise('Invalid association type: "'+h.type+'"');}}}if(e){e=Ext.isArray(e)?e:[e];for(f=0,b=e.length;f<b;++f){d.addBelongsTo(l,e[f]);}}if(j){j=Ext.isArray(j)?j:[j];for(f=0,b=j.length;f<b;++f){d.addHasMany(l,j[f]);}}if(m){m=Ext.isArray(m)?m:[m];for(f=0,b=m.length;
f<b;++f){d.addHasOne(l,m[f]);}}d.afterKeylessAssociations(l);},initIdentifier:function(f,a,e){var b=f.identifier||f.idgen,d=e.identifier||a.schema._defaultIdentifier,c;if(f.idgen){Ext.log.warn("Ext.data.Model: idgen has been deprecated. Please use identifier instead.");}if(b){delete f.identifier;delete f.idgen;
b=Ext.Factory.dataIdentifier(b);}else{if(d){if(d.clone&&!d.getId()){b=d.clone();}else{if(d.isGenerator){b=d;}else{b=Ext.Factory.dataIdentifier(d);}}}}a.identifier=e.identifier=b;if(!b){c=a.entityName;if(!c){c=Ext.id(null,"extModel");}a.identifier=Ext.Factory.dataIdentifier({type:"sequential",prefix:c+"-"});
}},findValidator:function(c,d,b){var f=b.type||b,h=c[d],a,e,g;if(h){for(e=0,a=h.length;e<a;++e){g=h[e];if(g.type===f){return g;}}}return null;},makeInitializeFn:function(p){var a=["var "],g=["\nreturn function (e) {\n    var data = e.data, v;\n"],m=0,j,h,k,o,d,l,f,e,n,c,b;if(!(f=p.rankedFields)){f=p.rankFields();
}for(c=0,b=f.length;c<b;++c){l=f[c];e="f"+c;k=l.convert;if(c){a.push(",  \n    ");}a.push(e," = $fields["+c+"]");a.push("  /*  ",l.name,"  */");if((n=(l.defaultValue!==undefined))||k){o='data["'+l.name+'"]';++m;j=h="";if(l.cloneDefaultValue){j="Ext.clone(";h=")";}g.push("\n");if(k&&n){g.push("    v = ",o,";\n"+"    if (v !== undefined) {\n"+"        v = ",e,".convert(v, e);\n"+"    }\n"+"    if (v === undefined) {\n"+"        v = ",j,e,".defaultValue",h,";\n"+"    }\n"+"    ",o," = v;");
}else{if(k){g.push("    v = ",e,".convert(",o,",e);\n"+"    if (v !== undefined) {\n"+"        ",o," = v;\n"+"    }\n");}else{if(n){g.push("    if (",o," === undefined) {\n"+"        ",o," = ",j,e,".defaultValue",h,";\n"+"    }\n");}}}}}if(!m){return Ext.emptyFn;}a.push(";\n");a.push.apply(a,g);a.push("}");
a=a.join("");d=new Function("$fields","Ext",a);return d(f,Ext);}}}},function(){var d=this,c=d.prototype,b=Ext.data.schema.Schema,a;d.proxyConfig=c.proxy;delete c.proxy;d.fields=[];d.fieldsMap=c.fieldsMap={};d.schema=c.schema=b.get(c.schema);c.idField=new Ext.data.field.Field(c.idProperty);d.identifier=new Ext.data.identifier.Sequential();
d.onExtended(function(e,j){var i=e.prototype,l=j.schema,k=i.superclass.self,h,g,f;e.idProperty=j.idProperty||i.idProperty;if(l){delete j.schema;h=b.get(l);}else{if(!(h=i.schema)){h=a||(a=b.get("default"));}}e.rankFields=d.rankFields;e.topoAdd=d.topoAdd;i.schema=e.schema=h;if(!(g=j.entityName)){i.entityName=g=h.getEntityName(e);
if(!g){if(j.associations){Ext.raise('Anonymous entities cannot specify "associations"');}if(j.belongsTo){Ext.raise('Anonymous entities cannot specify "belongsTo"');}if(j.hasMany){Ext.raise('Anonymous entities cannot specify "hasMany"');}if(j.hasOne){Ext.raise('Anonymous entities cannot specify "hasOne"');
}if(j.matrices){Ext.raise('Anonymous entities cannot specify "manyToMany"');}}}e.entityName=g;e.fieldExtractors={};d.initIdentifier(j,e,i);d.initFields(j,e,i);d.initValidators(j,e,i);if(!j.isSummaryModel){d.initSummaries(j,e,i);}e.fields.items=e.fields;if(g){h.addEntity(e);d.initAssociations(h,j,e);}f=j.proxy;
if(f){delete j.proxy;}else{if(k!==d){f=k.proxyConfig||k.proxy;}}e.proxyConfig=f;});});