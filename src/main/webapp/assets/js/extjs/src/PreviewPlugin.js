Ext.define("Ext.ux.PreviewPlugin",{extend:"Ext.plugin.Abstract",alias:"plugin.preview",requires:["Ext.grid.feature.RowBody"],hideBodyCls:"x-grid-row-body-hidden",bodyField:"",previewExpanded:true,setCmp:function(f){this.callParent(arguments);var d=this,c=d.cmp=f.isXType("gridview")?f.grid:f,a=d.bodyField,g=d.hideBodyCls,b=Ext.create("Ext.grid.feature.RowBody",{grid:c,getAdditionalData:function(l,i,j,m){var h=Ext.grid.feature.RowBody.prototype.getAdditionalData,k={rowBody:l[a],rowBodyCls:c.getView().previewExpanded?"":g};
if(Ext.isFunction(h)){Ext.apply(k,h.apply(this,arguments));}return k;}}),e=function(i,h){h.previewExpanded=d.previewExpanded;h.featuresMC.add(b);b.init(i);};if(c.view){e(c,c.view);}else{c.on({viewcreated:e,single:true});}},toggleExpanded:function(b){var c=this.getCmp(),a=c&&c.getView(),e=a.bufferedRenderer,d=a.scrollManager;
if(c&&a&&b!==a.previewExpanded){this.previewExpanded=a.previewExpanded=!!b;a.refreshView();if(d){if(e){e.stretchView(a,e.getScrollHeight(true));}else{d.refresh(true);}}}}});