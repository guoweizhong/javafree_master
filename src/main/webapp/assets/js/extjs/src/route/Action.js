Ext.define("Ext.route.Action",{config:{actions:null,befores:null,urlParams:[]},started:false,stopped:false,constructor:function(a){var b=this;b.deferred=new Ext.Deferred();b.resume=b.resume.bind(b);b.stop=b.stop.bind(b);b.initConfig(a);b.callParent([a]);},applyActions:function(a){if(a){a=Ext.Array.from(a);
}return a;},applyBefores:function(a){if(a){a=Ext.Array.from(a);}return a;},destroy:function(){this.deferred=null;this.setBefores(null).setActions(null).setUrlParams(null);this.callParent();},resume:function(){return this.next();},stop:function(){this.stopped=true;return this.done();},next:function(){var d=this,f=d.getActions(),e=d.getBefores(),a=d.getUrlParams().slice(),c,b;
if(d.stopped||(e?!e.length:true)&&(f?!f.length:true)){d.done();}else{if(e&&e.length){c=e.shift();a.push(d);b=Ext.callback(c.fn,c.scope,a);if(b&&b.then){b.then(function(g){d.resume(g);},function(g){d.stop(g);});}}else{if(f&&f.length){c=f.shift();Ext.callback(c.fn,c.scope,a);d.next();}else{d.next();}}}return d;
},run:function(){var a=this.deferred;if(!this.started){this.next();this.started=true;}return a.promise;},done:function(){var a=this.deferred;if(this.stopped){a.reject();}else{a.resolve();}this.destroy();return this;},before:function(e,c,b){if(Ext.isFunction(e)){b=c;c=e;e=false;}var d=this.getBefores(),a={fn:c,scope:b};
if(this.destroyed){Ext.raise("This action has has already resolved and therefore will never execute this function.");return;}if(d){if(e){d.unshift(a);}else{d.push(a);}}else{this.setBefores(a);}return this;},action:function(e,c,b){if(Ext.isFunction(e)){b=c;c=e;e=false;}var d=this.getActions(),a={fn:c,scope:b};
if(this.destroyed){Ext.raise("This action has has already resolved and therefore will never execute this function.");return;}if(d){if(e){d.unshift(a);}else{d.push(a);}}else{this.setActions(a);}return this;},then:function(b,a){if(this.destroyed){Ext.raise("This action has has already resolved and therefore will never execute either function.");
return;}return this.deferred.then(b,a);}});